{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/astar.ts","webpack:///./src/command.ts","webpack:///./src/config.ts","webpack:///./src/data.ts","webpack:///./src/editmode.ts","webpack:///./src/game/Collider.ts","webpack:///./src/game/GamePlayBehaviour.ts","webpack:///./src/game/Menu.ts","webpack:///./src/game/MoveBehaviour.ts","webpack:///./src/game/Slider.ts","webpack:///./src/game/UpdateScoreBehaviour.ts","webpack:///./src/game/utils.ts","webpack:///./src/gameengine.ts","webpack:///./src/index.ts","webpack:///./src/item.ts","webpack:///./src/math.ts","webpack:///./src/npc.ts","webpack:///./src/platform.ts","webpack:///./src/tilemap.ts","webpack:///./src/user.ts"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;;;AClFA,IAAiB,KAAK,CAoNrB;AApND,WAAiB,KAAK;IAElB;QAYI,cAAY,CAAS,EAAE,CAAS;YALhC,aAAQ,GAAY,IAAI,CAAC;YAEzB,mBAAc,GAAW,GAAG,CAAC;YAC7B,WAAM,GAAY,KAAK,CAAC;YAGpB,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;YACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACf,CAAC;QAED,uBAAQ,GAAR;YACI,IAAI,IAAI,CAAC,MAAM,EAAE;gBACb,OAAO,GAAG;aACb;iBACI,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBACrB,OAAO,GAAG;aACb;iBACI;gBACD,OAAO,GAAG;aACb;QACL,CAAC;QACL,WAAC;IAAD,CAAC;IA5BY,UAAI,OA4BhB;IAGD;QAMI,cAAY,OAAe,EAAE,OAAe;YACxC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;YACxB,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAC;YACxB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;YACjB,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;gBAC5C,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;gBACpB,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;oBAC5C,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;iBACtC;aACJ;QACL,CAAC;QAED,oBAAK,GAAL;YACI,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;gBAC5C,KAAK,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;oBAC5C,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC/B,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;oBAC7B,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;oBACpB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;iBACtB;aACJ;QACL,CAAC;QAEM,sBAAO,GAAd,UAAe,CAAS,EAAE,CAAS;YAC/B,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC;QAEM,0BAAW,GAAlB,UAAmB,CAAS,EAAE,CAAS,EAAE,KAAc;YACnD,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,GAAG,KAAK,CAAC;QACvC,CAAC;QAGD,sBAAW,yBAAO;iBAAlB;gBACI,OAAO,IAAI,CAAC,QAAQ,CAAC;YACzB,CAAC;;;WAAA;QAED,sBAAW,yBAAO;iBAAlB;gBACI,OAAO,IAAI,CAAC,QAAQ,CAAC;YACzB,CAAC;;;WAAA;QAEM,2BAAY,GAAnB,UAAoB,IAAU;YAC1B,IAAM,MAAM,GAAG,EAAE,CAAC;YAClB,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACvC,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACpD,IAAM,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACvC,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACpD,KAAK,IAAI,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,EAAE,EAAE;gBACjC,KAAK,IAAI,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,IAAI,EAAE,CAAC,EAAE,EAAE;oBACjC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;iBACnC;aACJ;YACD,OAAO,MAAM,CAAC;QAClB,CAAC;QAEM,uBAAQ,GAAf;YAEI,IAAI,MAAM,GAAG,EAAE,CAAC;YAEhB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;gBACpC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE;oBACpC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,EAAE,CAAC;iBAC1C;gBACD,MAAM,IAAI,IAAI;aACjB;YACD,OAAO,MAAM,CAAC;QAClB,CAAC;QAEL,WAAC;IAAD,CAAC;IAzEY,UAAI,OAyEhB;IAGD,IAAM,aAAa,GAAG,CAAC,CAAC;IAExB,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC;IAE7B;QAyBI;QAEA,CAAC;QAvBD,4BAAS,GAAT,UAAU,IAAU,EAAE,OAAa;YAC/B,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,aAAa;kBACnD,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,GAAG,aAAa,CAAC;YACnD,OAAO,IAAI,CAAC;QAChB,CAAC;QAED,4BAAS,GAAT,UAAU,IAAU,EAAE,OAAa;YAC/B,IAAM,EAAE,GAAG,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;YAC9B,IAAM,EAAE,GAAG,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC;YAC9B,OAAO,IAAI,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,GAAG,aAAa,CAAC;QACxD,CAAC;QAGD,2BAAQ,GAAR,UAAS,IAAU,EAAE,OAAa;YAC9B,IAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YACxC,IAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;YACxC,IAAM,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;YAC9B,IAAM,QAAQ,GAAG,EAAE,GAAG,EAAE,CAAC;YACzB,OAAO,SAAS,GAAG,IAAI,GAAG,aAAa,GAAG,CAAC,QAAQ,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC;QACpE,CAAC;QAMM,gCAAa,GAApB,UAAqB,SAAmB;YACpC,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAChC,CAAC;QAEM,2BAAQ,GAAf,UAAgB,IAAU,EAAE,MAAc,EAAE,MAAc,EAAE,IAAY,EAAE,IAAY;YAClF,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,IAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;YAC/C,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YACzC,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC;YAChB,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;YAClD,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC;YACxC,IAAM,QAAQ,GAAG,EAAE,CAAC;YACpB,IAAM,UAAU,GAAG,EAAE,CAAC;YACtB,IAAI,WAAW,GAAG,SAAS,CAAC;YAC5B,OAAO,WAAW,IAAI,OAAO,EAAE;gBAC3B,IAAM,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;gBACjD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;oBACvC,IAAM,QAAQ,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;oBAC9B,IAAI,QAAQ,IAAI,WAAW;wBACvB,CAAC,QAAQ,CAAC,QAAQ,EAAE;wBACpB,SAAS;qBACZ;oBACD,IAAI,IAAI,GAAG,aAAa,CAAC;oBACzB,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC,EAAE;wBACnE,IAAI,GAAG,SAAS,CAAC;qBACpB;oBACD,IAAM,CAAC,GAAG,WAAW,CAAC,CAAC,GAAG,IAAI,GAAG,QAAQ,CAAC,cAAc,CAAC;oBACzD,IAAM,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;oBAC7C,IAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;oBAChB,IAAI,QAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;wBACtE,IAAI,QAAQ,CAAC,CAAC,GAAG,CAAC,EAAE;4BAChB,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;4BACf,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;4BACf,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;4BACf,QAAQ,CAAC,MAAM,GAAG,WAAW,CAAC;yBACjC;6BACI;4BACD,OAAO;yBACV;qBACJ;yBACI;wBACD,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;wBACf,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;wBACf,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;wBACf,QAAQ,CAAC,MAAM,GAAG,WAAW,CAAC;wBAC9B,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;qBAE3B;iBACJ;gBACD,UAAU,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;gBAE7B,IAAI,QAAQ,CAAC,MAAM,IAAI,CAAC,EAAE;oBACtB,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;oBAC7B,OAAO,IAAI,CAAC;iBACf;gBACD,QAAQ,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC,IAAK,QAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAT,CAAS,CAAC,CAAC;gBACnC,WAAW,GAAG,QAAQ,CAAC,KAAK,EAAE,CAAC;aAClC;YACD,IAAM,IAAI,GAAG,EAAE,CAAC;YAChB,IAAI,UAAU,GAAG,OAAO,CAAC;YACzB,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACtB,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;YACzB,OAAO,UAAU,IAAI,SAAS,EAAE;gBAC5B,UAAU,GAAG,UAAU,CAAC,MAAM,CAAC;gBAC/B,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;gBACzB,UAAU,CAAC,MAAM,GAAG,IAAI,CAAC;aAC5B;YACD,OAAO,IAAI,CAAC;QAChB,CAAC;QACL,eAAC;IAAD,CAAC;IAlGY,cAAQ,WAkGpB;AACL,CAAC,EApNgB,KAAK,GAAL,aAAK,KAAL,aAAK,QAoNrB;;;;;;;;;;;;;;;ACpND;IAAA;QAGY,iBAAY,GAAkB,EAAE,CAAC;QACjC,mBAAc,GAAgB,IAAI,CAAC;IAiC/C,CAAC;IA/BG,0BAAI,GAAJ,UAAK,OAAoB;QACrB,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC;YAC7B,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;SAC9B;QACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IACpC,CAAC;IAED,6CAAuB,GAAvB;QACI,IAAI,CAAC,0BAA0B,EAAE,CAAC;IACtC,CAAC;IAEO,gDAA0B,GAAlC;QAAA,iBAiBC;QAhBG,IAAI,IAAI,CAAC,cAAc,EAAE;YACrB,OAAO;SACV;QACD,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,IAAI,CAAC,EAAE;YAC/B,OAAO;SACV;QACD,IAAM,OAAO,GAAG,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC;QAC1C,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC;QAC9B,OAAO,CAAC,UAAU,GAAG;YACjB,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC;YAC3B,KAAI,CAAC,0BAA0B,EAAE,CAAC;QACtC,CAAC;QACD,OAAO,CAAC,OAAO,EAAE,CAAC;IAItB,CAAC;IACL,kBAAC;AAAD,CAAC;AArCY,kCAAW;AAuCxB;IAAA;IAQA,CAAC;IAAD,kBAAC;AAAD,CAAC;AARqB,kCAAW;;;;;;;;;;;;;;;AChCpB,kBAAU,GAAqB;IACxC,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,EAAE,kBAAkB,EAAE;IACvD,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,kBAAkB,EAAE;CACtD;;;;;;;;;;;;;;;ACHY,oBAAY,GAAuB;IAC5C,OAAO,EAAE;QACL,EAAE,UAAU,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;QACpD,EAAE,UAAU,EAAE,gBAAgB,EAAE,SAAS,EAAE,iBAAiB,EAAE;KACjE;CACJ;AAEY,kBAAU,GAAuB;IAC1C,OAAO,EAAE;QACL,EAAE,UAAU,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC,EAAE;QACpD;YACI,UAAU,EAAE,gBAAgB;SAC/B;KACJ;CACJ;;;;;;;;;;;;;;;ACrBD,kFAAkE;AAClE,kFAA6G;AAE7G;IAAA;QAEY,mBAAc,GAAG,EAAE,CAAC;IA6FhC,CAAC;IAzFG,+BAAW,GAAX,UAAY,QAA6B;QACrC,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAED,wBAAI,GAAJ;QAEI,IAAM,QAAQ,GAAG,qCAAwB,CAAC,iBAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;QAClE,IAAM,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACrD,OAAO,OAAO,CAAC;IAEnB,CAAC;IAED,iCAAa,GAAb;QACI,IAAM,SAAS,GAAG,iBAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QACzC,IAAM,UAAU,GAAG,IAAI,uBAAU,EAAE,CAAC;QACpC,IAAM,SAAS,GAAG,IAAI,sBAAS,EAAE,CAAC;QAClC,UAAU,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAChC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IACnC,CAAC;IAED,6BAAS,GAAT,UAAU,cAAqB,EAAC,UAAiB;QAC7C,IAAM,SAAS,GAAG,iBAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;QACzC,IAAM,MAAM,GAAG,yBAAY,CAAC,EAAC,UAAU,EAAC,UAAU,EAAC,CAAC;QACpD,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;IAChC,CAAC;IAED,kCAAc,GAAd;QACI,OAAO,2BAAc,EAAE,CAAC;IAC5B,CAAC;IAED,qCAAiB,GAAjB,UAAkB,UAAkB,EAAE,QAAsC;QACxE,IAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;QAC/C,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC;IAC3C,CAAC;IAED,kCAAc,GAAd;QACI,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAM,MAAM,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;YAC9B,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;YACnB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;SACzB;IACL,CAAC;IAID,+BAAW,GAAX,UAAY,QAAe;QACvB,IAAI,CAAC,oBAAoB,GAAG,QAAQ,CAAC;QACrC,iBAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;IAC7B,CAAC;IAGO,2BAAO,GAAf;QACI,IAAM,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC;QAC3C,IAAI,cAAc,GAAG,CAAC,CAAC;QACvB,IAAI,UAAU,GAAG,CAAC,CAAC;QACnB,SAAS,iBAAiB,CAAC,UAAsB;YAC7C,cAAc,EAAE,CAAC;YACjB,IAAM,IAAI,GAAG,UAAU,CAAC,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,EAAE,GAAE,GAAG,GAAE,cAAc,CAAC,CAAC,CAAC,UAAU,GAAG,cAAc,CAAC;YAC9F,IAAM,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,eAAK,IAAI,wBAAiB,CAAC,KAAK,CAAC,EAAxB,CAAwB,CAAC,CAAC;YAE5E,IAAM,OAAO,GAAG,UAAU,CAAC,QAAQ,CAAC,GAAG,CAAC,gBAAM;gBAC1C,UAAU,EAAE,CAAC;gBACb,cAAc,CAAC,UAAU,CAAC,GAAG,MAAM,CAAC;gBACpC,IAAM,UAAU,GAAG,EAAE;gBACrB,IAAM,gBAAgB,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC;gBAC9D,IAAI,gBAAgB,EAAE;4CACT,IAAI;wBACT,IAAM,QAAQ,GAAG;4BACb,IAAI,EAAE,IAAI,CAAC,GAAG;4BACd,oBAAoB,EAAE,UAAC,IAAI;gCACvB,OAAO,IAAI,CAAC,qBAAqB,CAAC,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;4BAC9D,CAAC;yBACJ,CAAC;wBACF,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC;;oBAP7B,KAAiB,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB;wBAA5B,IAAI,IAAI;gCAAJ,IAAI;qBASZ;iBACJ;gBAGD,OAAO;oBACH,IAAI,EAAE,MAAM,CAAC,IAAI,EAAE,UAAU,cAAE,IAAI,EAAE,UAAU;iBAClD;YACL,CAAC,CAAC;YACF,OAAO,EAAE,IAAI,QAAE,QAAQ,YAAE,OAAO,WAAC,IAAI,EAAC,cAAc,EAAE;QAC1D,CAAC;QACD,OAAO,iBAAiB,CAAC,iBAAI,CAAC,KAAK,CAAC,CAAC;IAEzC,CAAC;IACL,gBAAC;AAAD,CAAC;AA/FY,8BAAS;AAiGT,iBAAS,GAAG,IAAI,SAAS,EAAE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpGzC,mFAA0C;AAG1C,IAAM,SAAS,GAAG,IAAI,CAAC;AAEvB,IAAM,YAAY,GAAG,IAAI,CAAC;AAK1B;IAA8B,4BAAS;IAAvC;QAAA,qEA6DC;QA3DG,gBAAU,GAAW,CAAC,CAAC;QAGvB,eAAS,GAAW,CAAC,CAAC;QAEtB,cAAQ,GAAW,IAAI,CAAC;QAExB,WAAK,GAAU,SAAS,CAAC;QACjB,gBAAU,GAAG,CAAC,CAAC;;IAmD3B,CAAC;IAjDG,8BAAW,GAAX,UAAY,KAAY;QACpB,IAAI,IAAI,CAAC,KAAK,IAAI,KAAK,EAAE;YACrB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;SAC7B;IACL,CAAC;IAEO,gCAAa,GAArB,UAAsB,EAAS;QAC3B,OAAO,CAAC,GAAG,CAAC,QAAQ,EAAE,EAAE,CAAC;IAC7B,CAAC;IAES,0BAAO,GAAjB;IAEA,CAAC;IAES,2BAAQ,GAAlB,UAAmB,YAAoB;QACnC,IAAI,CAAC,UAAU,IAAI,YAAY,CAAC;QAChC,IAAI,IAAI,CAAC,KAAK,KAAK,SAAS,EAAE;YAC1B,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,GAAG,SAAS,EAAE;gBAChD,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC;aAChC;SACJ;aACI,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW,EAAE;YACjC,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,GAAG,SAAS,GAAG,YAAY,EAAE;gBAC/D,IAAI,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;aAC/B;SACJ;aACI,IAAI,IAAI,CAAC,KAAK,KAAK,yBAAyB,EAAE;YAC/C,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,GAAG,SAAS,GAAG,IAAI,CAAC,QAAQ,EAAE;gBAChE,IAAI,CAAC,WAAW,CAAC,sBAAsB,CAAC;aAC3C;SACJ;IACL,CAAC;IAED,0BAAO,GAAP,UAAQ,IAAY;QAChB,IAAI,IAAI,IAAI,IAAI,CAAC,UAAU,GAAG,SAAS;YACnC,IAAI,IAAI,IAAI,CAAC,UAAU,GAAG,SAAS,GAAG,YAAY,EACpD;YACE,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC;YACxB,OAAO,IAAI,CAAC;SACf;QACD;YACI,OAAO,KAAK,CAAC;SAChB;IAEL,CAAC;IAIL,eAAC;AAAD,CAAC,CA7D6B,sBAAS,GA6DtC;AA7DY,4BAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVrB,mFAAsD;AACtD,iEAA+B;AAC/B,wEAA0C;AAC1C,6EAA0C;AAC1C,iFAAsC;AAItC;IAAuC,qCAAS;IAAhD;QAAA,qEAgFC;QA9EW,gBAAU,GAAG,CAAC,CAAC;QAGf,WAAK,GAAS,IAAI,CAAC;QAGnB,oBAAc,GAAU,CAAC,CAAC,CAAC;QAE3B,iBAAW,GAAgB,EAAE,CAAC;;IAsE1C,CAAC;IApEa,mCAAO,GAAjB;QAAA,iBA4BC;QAzBG,IAAM,UAAU,GAAG,uBAAe,EAAE,CAAC;QACrC,IAAM,QAAQ,GAAG,IAAI,mBAAQ,EAAE,CAAC;QAChC,UAAU,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;QAC/B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QAClC,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;QAExC,sBAAW,EAAE,CAAC,WAAW,CAAC,UAAC,KAAK;YAC5B,IAAI,KAAK,CAAC,IAAI,KAAK,YAAY,EAAC;gBAC5B,IAAI,KAAI,CAAC,cAAc,IAAI,CAAC,CAAC,EAAC;oBAC1B,KAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;oBACzB,KAAI,CAAC,cAAc,GAAG,KAAK,CAAC,OAAO,CAAC;iBACvC;aAEJ;iBACI,IAAI,KAAK,CAAC,IAAI,KAAK,UAAU,EAAC;gBAC/B,IAAI,KAAI,CAAC,cAAc,KAAK,KAAK,CAAC,OAAO,EAAC;oBACtC,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;oBACvB,KAAI,CAAC,cAAc,GAAG,CAAC,CAAC,CAAC;iBAC5B;aACJ;QAEL,CAAC,CAAC;IAIN,CAAC;IAEO,0CAAc,GAAtB,UAAuB,EAAQ;QAC3B,OAAO,CAAC,GAAG,CAAC,OAAO,EAAC,EAAE,CAAC;QACvB,IAAM,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QACrC,IAAM,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,mBAAQ,CAAC,CAAC;QACjD,IAAI,EAAE,KAAK,MAAM,EAAC;YAEd,IAAI,KAAK,CAAC,KAAK,KAAK,SAAS,EAAC;gBAC1B,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;aACzB;iBACI,IAAI,KAAK,CAAC,KAAK,KAAK,WAAW,EAAC;gBACjC,KAAK,CAAC,WAAW,CAAC,yBAAyB,CAAC;aAC/C;SACJ;aACI,IAAI,EAAE,KAAI,IAAI,EAAC;YAChB,IAAI,KAAK,CAAC,KAAK,KAAK,yBAAyB,EAAC;gBAC1C,KAAK,CAAC,WAAW,CAAC,cAAc,CAAC;aACpC;iBACI,IAAI,KAAK,CAAC,KAAK,KAAK,sBAAsB,EAAC;gBAC5C,KAAK,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;aACxC;SACJ;IACL,CAAC;IAEO,uCAAW,GAAnB,UAAoB,KAAW;QAC3B,IAAI,IAAI,CAAC,KAAK,IAAI,KAAK,EAAC;YACpB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;SAC9B;IACL,CAAC;IAEU,oCAAQ,GAAlB,UAAmB,YAAoB;QAEpC,IAAI,CAAC,UAAU,IAAI,YAAY,CAAC;QAChC,WAAI,CAAC,KAAK,GAAI,IAAI,CAAC,UAAU;IACjC,CAAC;IAIL,wBAAC;AAAD,CAAC,CAhFsC,sBAAS,GAgF/C;AAhFY,8CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACR9B,mFAAgD;AAChD,2EAAkC;AAClC,wEAAuC;AAEvC;IAA0B,wBAAS;IAAnC;;IAwBA,CAAC;IAvBG,sBAAO,GAAP;QAEI,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,eAAM,CAAC,CAAC;QACpD,MAAM,CAAC,oBAAoB,GAAG,UAAC,IAAI;YAC/B,OAAO,oBAAY,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACxC,CAAC;QACD,MAAM,CAAC,KAAK,GAAG;YACX,EAAC,SAAS,EAAC,kBAAkB,EAAC;YAC9B,EAAC,SAAS,EAAC,kBAAkB,EAAC;YAC9B,EAAC,SAAS,EAAC,kBAAkB,EAAC;SACjC;QACD,MAAM,CAAC,QAAQ,GAAG,UAAC,IAAI;YACnB,iBAAI,CAAC,SAAS,CAAC,wBAAwB,CAAC;QAC5C,CAAC;QACD,MAAM,CAAC,SAAS,GAAG,MAAM,CAAC,UAAU,GAAG,EAAE,CAAC;IAC9C,CAAC;IAED,uBAAQ,GAAR,UAAS,YAAoB;IAE7B,CAAC;IAIL,WAAC;AAAD,CAAC,CAxByB,sBAAS,GAwBlC;AAxBY,oBAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJjB,mFAAqD;AAErD;IAAmC,iCAAS;IAA5C;QAAA,qEAoCC;QAlCG,cAAQ,GAAU,GAAG,CAAC;QAEtB,aAAO,GAAU,CAAC,CAAC;QAEX,gBAAU,GAAG,CAAC,CAAC;QAEf,YAAM,GAAU,CAAC,CAAC;;IA4B9B,CAAC;IA1BG,+BAAO,GAAP;QACI,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;QAC1D,IAAI,CAAC,MAAM,GAAI,SAAS,CAAC,CAAC,CAAC;IAC/B,CAAC;IAED,gCAAQ,GAAR,UAAS,YAAmB;QAExB,SAAS,IAAI,CAAC,CAAQ;YAClB,OAAO,CAAC,CAAC,CAAC,GAAE,CAAC,CAAC,GAAC,CAAC,CAAC,GAAC,CAAC,CAAC,GAAG,CAAC,CAAC;QAC7B,CAAC;QAED,IAAI,CAAC,UAAU,IAAI,YAAY,CAAC;QAEhC,IAAI,QAAQ,GAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE/C,IAAI,QAAQ,GAAG,CAAC,EAAE;YACd,QAAQ,GAAG,CAAC,CAAC;SAChB;QACD,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QACzB,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;QAC1D,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,GAAG,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC;QAEpD,IAAI,QAAQ,IAAI,CAAC,EAAC;YACd,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;SACzC;IACL,CAAC;IACL,oBAAC;AAAD,CAAC,CApCkC,sBAAS,GAoC3C;AApCY,sCAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACF1B,mFAAoI;AACpI,gGAAgD;AAChD,wEAAwD;AAExD;IAA4B,0BAAS;IAArC;QAAA,qEA4DC;QAzDG,kBAAY,GAAW,CAAC,CAAC;QAEzB,mBAAa,GAAW,CAAC,CAAC;;IAuD9B,CAAC;IA1CG,wBAAO,GAAP;QAAA,iBAkCC;QAjCG,IAAM,SAAS,GAAG,uBAAe,EAAE,CAAC;QACpC,IAAM,YAAY,GAAG,IAAI,yBAAY,EAAE,CAAC;QACxC,YAAY,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QAC9C,YAAY,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QAChD,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;QAE3C,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACvC,IAAM,KAAK,GAAG,CAAC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;QACvD,IAAM,KAAK,GAAG,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;QAEzD,IAAI,KAAK,GAAG,CAAC,CAAC;gCACL,IAAI;YACT,IAAM,cAAc,GAAG,OAAK,oBAAoB,CAAC,IAAI,CAAC,CAAC;YACvD,IAAM,aAAa,GAAG,cAAc,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;YAC1D,aAAa,CAAC,CAAC,GAAG,KAAK,CAAC;YACxB,aAAa,CAAC,CAAC,GAAG,KAAK,GAAG,OAAK,aAAa,GAAG,KAAK;YACpD,SAAS,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;YACnC,IAAM,SAAO,GAAG,cAAc,CAAC,SAAS,CAAC,0BAAa,CAAC,CAAC;YACxD,SAAO,CAAC,OAAO,GAAG;gBACd,IAAI,KAAI,CAAC,QAAQ,EAAC;oBACd,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;iBACvB;gBACD,OAAO,IAAI,CAAC;YAChB,CAAC;YACD,KAAK,EAAE,CAAC;;;QAbZ,KAAiB,UAAU,EAAV,SAAI,CAAC,KAAK,EAAV,cAAU,EAAV,IAAU;YAAtB,IAAI,IAAI;oBAAJ,IAAI;SAcZ;QAED,IAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,0BAAa,CAAC,CAAC;QAC5D,OAAO,CAAC,OAAO,GAAG;YACd,IAAM,IAAI,GAAG,IAAI,6BAAa,EAAE,CAAC;YACjC,IAAI,CAAC,OAAO,GAAG,CAAC,KAAI,CAAC,aAAa;YAClC,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QAC9B,CAAC;IACL,CAAC;IAID,yBAAQ,GAAR,cAAa,CAAC;IArDd;QADC,0BAAa,CAAC,kCAAqB,CAAC;gDACZ;IAEzB;QADC,0BAAa,CAAC,kCAAqB,CAAC;iDACX;IAuD9B,aAAC;CAAA,CA5D2B,sBAAS,GA4DpC;AA5DY,wBAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJnB,mFAAwD;AACxD,iEAA+B;AAE/B;IAA0C,wCAAS;IAAnD;;IAYA,CAAC;IAVa,sCAAO,GAAjB;IAEA,CAAC;IAES,uCAAQ,GAAlB,UAAmB,YAAoB;QACnC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,yBAAY,CAAC,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,WAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;IACtC,CAAC;IAGL,2BAAC;AAAD,CAAC,CAZyC,sBAAS,GAYlD;AAZY,oDAAoB;;;;;;;;;;;;;;;ACHjC,mFAAsE;AAEtE,SAAgB,YAAY,CAAC,GAAU;IACnC,IAAM,UAAU,GAAG,IAAI,uBAAU,EAAE,CAAC;IACpC,IAAM,SAAS,GAAG,IAAI,sBAAS,EAAE,CAAC;IAClC,UAAU,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;IAChC,IAAM,cAAc,GAAG,IAAI,2BAAc,EAAE,CAAC;IAC5C,UAAU,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;IACrC,cAAc,CAAC,SAAS,GAAG,GAAG,CAAC;IAC/B,OAAO,UAAU,CAAC;AACtB,CAAC;AARD,oCAQC;AAED,SAAgB,eAAe;IAC3B,IAAM,UAAU,GAAG,IAAI,uBAAU,EAAE,CAAC;IACpC,IAAM,SAAS,GAAG,IAAI,sBAAS,EAAE,CAAC;IAClC,UAAU,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;IAChC,OAAO,UAAU,CAAC;AACtB,CAAC;AALD,0CAKC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBD,4EAAuC;AACvC,gEAA4F;AAC5F,4EAAyC;AAEzC,+CAA+C;AAE/C,yBAAyB;AAEzB,IAAM,IAAI,GAAoB,UAAC,MAAM,EAAE,GAAG,EAAE,IAAS;IACjD,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC;IAC1B,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC;IACvB,IAAI,CAAC,KAAK,GAAG;QACT,IAAM,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QAC7B,IAAM,MAAM,GAAG,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;QAC7C,IAAM,OAAO,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;QAC3B,IAAM,IAAI,GAAG,OAAO,GAAG,SAAS,CAAC;QACjC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAC1B,OAAO,MAAM,CAAC;IAClB,CAAC;AACL,CAAC;AAED,SAAS,kBAAkB,CAAC,GAAG,EAAE,KAAK;IAClC,IAAM,GAAG,GAAG,EAAE,CAAC;IACf,GAAG,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;IACjB,OAAO,GAAG,CAAC;AACf,CAAC;AAEY,6BAAqB,GAA0B,UAAC,IAAI,EAAE,MAAM,EAAE,GAAG;IAE1E,IAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;IAC1B,IAAM,GAAG,GAAG,kBAAkB,CAAC,GAAG,EAAE,KAAK,CAAC;IAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IACxD,UAAU,CAAC,QAAQ,CAAC,UAAU,KAAK;QAC/B,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;IAEH,UAAU,CAAC,cAAc,CAAC,UAAU,KAAK;QACrC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;AACP,CAAC,CAAC;AAEW,6BAAqB,GAA0B,UAAC,IAAI,EAAE,MAAM,EAAE,GAAG;IAC1E,IAAM,KAAK,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;IAC1B,IAAM,GAAG,GAAG,kBAAkB,CAAC,GAAG,EAAE,KAAK,CAAC;IAC1C,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;IACjD,UAAU,CAAC,QAAQ,CAAC,UAAU,KAAK;QAC/B,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;IAEH,UAAU,CAAC,cAAc,CAAC,UAAU,KAAK;QACrC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;IAC1B,CAAC,CAAC,CAAC;AACP,CAAC;AAEY,2BAAmB,GAA0B,UAAC,IAAI,EAAE,MAAM,EAAE,GAAG;IACxE,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC;AAClC,CAAC;AAuBY,qBAAa,GAAG,UAAC,qBAA4C,IAAK,iBAAC,MAAM,EAAE,GAAG;IAGvF,IAAM,GAAG,GAAG,MAAa,CAAC;IAC1B,IAAI,CAAC,GAAG,CAAC,gBAAgB,EAAE;QACvB,GAAG,CAAC,gBAAgB,GAAG,EAAE,CAAC;KAC7B;IAGD,GAAG,CAAC,gBAAgB,CAAC,IAAI,CAAC;QACtB,GAAG,OAAE,qBAAqB;KAC7B,CAAC,CAAC;AACP,CAAC,EAZ8E,CAY9E;AAED;IAEI;QAQA,YAAO,GAAW,KAAK,CAAC;QAPpB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;IACtC,CAAC;IAUD,yBAAK,GAAL;IAEA,CAAC;IAED,kCAAc,GAAd;IACA,CAAC;IAGD,gCAAY,GAAZ;QACI,IAAI,CAAC,IAAI,CAAC,OAAO,EAAC;YACd,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,OAAO,EAAE,CAAC;SAClB;QACD,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAED,0BAAM,GAAN,UAAO,YAAmB;QACtB,IAAI,CAAC,IAAI,CAAC,OAAO,EAAC;YACd,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;YACpB,IAAI,CAAC,OAAO,EAAE,CAAC;SAClB;QACD,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IAChC,CAAC;IAIL,gBAAC;AAAD,CAAC;AAxCqB,8BAAS;AA0C/B;IAAkD,uCAAS;IAA3D;;IAcA,CAAC;IAZG,sCAAQ,GAAR,UAAS,OAAiC;IAE1C,CAAC;IAED,2CAAa,GAAb,UAAc,OAAiC;IAE/C,CAAC;IAED,2CAAa,GAAb;QACI,OAAO,IAAI,CAAC;IAChB,CAAC;IAEL,0BAAC;AAAD,CAAC,CAdiD,SAAS,GAc1D;AAdqB,kDAAmB;AAgBzC;IAAA;IAGA,CAAC;IAAD,iBAAC;AAAD,CAAC;AAHY,gCAAU;AAMvB;IAmBI,oBAAY,OAAwB;QAAxB,yCAAwB;QAdpC,UAAK,GAAW,CAAC,CAAC;QAEV,gBAAW,GAAW,CAAC,CAAC;QAIxB,YAAO,GAAY,KAAK,CAAC;QAEjC,aAAQ,GAAiB,EAAE,CAAC;QAyB5B,aAAQ,GAAgB,EAAE,CAAC;QAlBvB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;QAC1C,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;IAClC,CAAC;IAED,6BAAQ,GAAR,UAAS,aAAyB;QAC9B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAClC,aAAa,CAAC,MAAM,GAAG,IAAI,CAAC;QAC5B,oBAAS,CAAC,cAAc,EAAE,CAAC;IAC/B,CAAC;IAED,gCAAW,GAAX,UAAY,aAAyB;QACjC,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QACnD,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC/B,oBAAS,CAAC,cAAc,EAAE,CAAC;IAC/B,CAAC;IAKD,8BAAS,GAAT,UAAU,MAAiB;QACvB,MAAM,CAAC,aAAa,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC/B,CAAC;IAED,iCAAY,GAAZ,UAAa,MAAiB;QAC1B,IAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;QAC5C,IAAI,KAAK,IAAI,CAAC,EAAE;YACZ,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC5B,MAAM,CAAC,KAAK,EAAE,CAAC;SAClB;IACL,CAAC;IAED;;OAEG;IACH,8BAAS,GAAT,UAA+B,GAAiB;QAC5C,KAAmB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA7B,IAAI,MAAM;YACX,IAAI,MAAM,CAAC,WAAW,KAAK,GAAG,EAAE;gBAC5B,OAAO,MAAW,CAAC;aACtB;SACJ;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAGD,6BAAQ,GAAR,UAAS,YAAoB;QACzB,KAAmB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA7B,IAAI,MAAM;YACX,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;SAC/B;QACD,KAAkB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA5B,IAAI,KAAK;YACV,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;SAChC;IACL,CAAC;IAED,mCAAc,GAAd;QACI,KAAmB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA7B,IAAI,MAAM;YACX,MAAM,CAAC,YAAY,EAAE,CAAC;SACzB;QACD,KAAkB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA5B,IAAI,KAAK;YACV,KAAK,CAAC,cAAc,EAAE,CAAC;SAC1B;IACL,CAAC;IAED,yBAAI,GAAJ,UAAK,OAAiC;QAClC,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,YAAY;QAC3D,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE;YACf,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC;SAC3D;QACD,OAAO,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;QACvC,OAAO,CAAC,YAAY,CAChB,YAAY,CAAC,CAAC,EACd,YAAY,CAAC,CAAC,EACd,YAAY,CAAC,CAAC,EACd,YAAY,CAAC,CAAC,EACd,YAAY,CAAC,EAAE,EACf,YAAY,CAAC,EAAE,CAClB;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;SACrC;QACD,KAAkB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAA5B,IAAI,KAAK;YACV,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACvB;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;SAC1C;IACL,CAAC;IACL,iBAAC;AAAD,CAAC;AA5GY,gCAAU;AA8GvB;IAAkC,gCAAmB;IAArD;QAAA,qEA2BC;QAzBI,kBAAY,GAAU,CAAC,CAAC;QACxB,mBAAa,GAAU,CAAC,CAAC;;IAwB9B,CAAC;IAtBG,8BAAO,GAAP;QACI,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,IAAI,CAAC;IACzC,CAAC;IACD,+BAAQ,GAAR,UAAS,YAAoB;IAE7B,CAAC;IAED,oCAAa,GAAb;QACI,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,YAAY,EAAE,MAAM,EAAE,IAAI,CAAC,aAAa,EAAE;IAC/E,CAAC;IAED,+BAAQ,GAAR,UAAS,OAAiC;QACtC,OAAO,CAAC,IAAI,EAAE,CAAC;QACf,OAAO,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QAC1D,OAAO,CAAC,IAAI,EAAE,CAAC;IACnB,CAAC;IAED,oCAAa,GAAb,UAAc,OAAiC;QAC3C,OAAO,CAAC,OAAO,EAAE,CAAC;IACtB,CAAC;IAGL,mBAAC;AAAD,CAAC,CA3BiC,mBAAmB,GA2BpD;AA3BY,oCAAY;AA8BzB;IAAoC,kCAAmB;IAAvD;;IA2BA,CAAC;IAtBG,gCAAO,GAAP;QACI,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,IAAI,CAAC;IACzC,CAAC;IAED,iCAAQ,GAAR;IACA,CAAC;IAED,iCAAQ,GAAR,UAAS,OAAiC;QACtC,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,IAAM,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACvC,OAAO,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;SAClC;IACL,CAAC;IAED,sCAAa,GAAb;QACI,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,IAAM,KAAK,GAAG,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACvC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,CAAC,MAAM,EAAE;SAClE;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAtBD;QADC,qBAAa,CAAC,6BAAqB,CAAC;qDACnB;IAwBtB,qBAAC;CAAA,CA3BmC,mBAAmB,GA2BtD;AA3BY,wCAAc;AA8B3B;IAAkC,gCAAmB;IAArD;QAAA,qEA+BC;QA3BG,UAAI,GAAW,EAAE,CAAC;QAGlB,cAAQ,GAAW,EAAE,CAAC;;IAwB1B,CAAC;IAtBG,8BAAO,GAAP;QACI,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,IAAI,CAAC;IACzC,CAAC;IAED,+BAAQ,GAAR;IAEA,CAAC;IAED,+BAAQ,GAAR,UAAS,OAAiC;QACtC,IAAM,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QACpC,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,QAAQ,GAAG,UAAU;QACzC,OAAO,CAAC,SAAS,GAAG,SAAS,CAAC;QAC9B,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,KAAiB,UAAK,EAAL,eAAK,EAAL,mBAAK,EAAL,IAAK,EAAE;YAAnB,IAAI,IAAI;YACT,SAAS,EAAE,CAAC;YACZ,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC,QAAQ,GAAG,SAAS,CAAC,CAAC;SACxD;IACL,CAAC;IAED,oCAAa,GAAb;QACI,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;IAClD,CAAC;IA1BD;QADC,qBAAa,CAAC,6BAAqB,CAAC;8CACnB;IAGlB;QADC,qBAAa,CAAC,6BAAqB,CAAC;kDACf;IAwB1B,mBAAC;CAAA,CA/BiC,mBAAmB,GA+BpD;AA/BY,oCAAY;AAiCzB,IAAM,MAAM,GAAwC,EAAE,CAAC;AAEvD,SAAgB,QAAQ,CAAC,GAAW;IAChC,OAAO,MAAM,CAAC,GAAG,CAAC,CAAC;AACvB,CAAC;AAFD,4BAEC;AAED;IAOI;QAFA,UAAK,GAAG,IAAI,UAAU,CAAC,IAAI,CAAC,CAAC;QA+DrB,aAAQ,GAAW,CAAC,CAAC;QA5DzB,IAAI,CAAC,MAAM,GAAG,sBAAW,EAAE,CAAC,aAAa,EAAE,CAAC;QAC5C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAC5C,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,SAAS,EAAE,CAAC,CAAC;IAC1C,CAAC;IAKD,kCAAS,GAAT,UAAU,GAAW;QACjB,IAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC1C,GAAG,CAAC,GAAG,GAAG,GAAG,CAAC;QACd,MAAM,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC;IACtB,CAAC;IAID,kCAAS,GAAT,UAAU,QAAgB;QAA1B,iBAQC;QANG,sBAAW,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,UAAC,IAAI;YAClC,IAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC9B,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC;IAGN,CAAC;IAED,oCAAW,GAAX,UAAY,IAAqB;QAC7B,IAAI,IAAI,CAAC,YAAY,EAAE;YACnB,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;SAC7C;QACD,IAAM,iBAAiB,GAAG,gBAAgB,CAAC,IAAI,CAAC;QAChD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,iBAAiB,CAAC,CAAC;QACvC,IAAI,CAAC,YAAY,GAAG,iBAAiB,CAAC;IAC1C,CAAC;IAED,qCAAY,GAAZ,UAAa,IAAqB;QAC9B,IAAM,UAAU,GAAG,gBAAgB,CAAC,IAAI,CAAC,CAAC;QAC1C,OAAO,UAAU,CAAC;IACtB,CAAC;IAED,8BAAK,GAAL;QAAA,iBAkBC;QAjBG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAErB,sBAAW,EAAE,CAAC,WAAW,CAAC,UAAC,MAAc,EAAE,MAAc;YACrD,IAAM,aAAa,GAAG,KAAI,CAAC,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;YAC1D,IAAM,oBAAoB,GAAG,aAAa,CAAC,OAAO,CAAC,MAAM,EAAE,MAAM,CAAC;YAClE,IAAI,aAAa,GAAG,oBAAoB,CAAC;YACzC,OAAO,aAAa,EAAE;gBAClB,IAAM,eAAa,GAAG,aAAa,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;gBAC7D,IAAI,eAAa,IAAI,eAAa,CAAC,OAAO,EAAE;oBACxC,IAAM,MAAM,GAAG,eAAa,CAAC,OAAO,CAAC,eAAa,CAAC,WAAW,EAAE,eAAa,CAAC,WAAW,CAAC,CAAC;oBAC3F,IAAI,MAAM,EAAC;wBACP,MAAM;qBACT;iBACJ;gBACD,aAAa,GAAG,aAAa,CAAC,MAAM,CAAC;aACxC;QACL,CAAC,CAAC;IACN,CAAC;IAID,qCAAY,GAAZ,UAAa,UAAkB;QAC3B,IAAM,YAAY,GAAG,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC;QAChD,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC;QAC3B,qBAAqB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;QACpD,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;IAC9B,CAAC;IAID;;;;;OAKG;IACH,+BAAM,GAAN,UAAO,YAAoB;QACvB,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QACpC,IAAI,CAAC,cAAc,EAAE,CAAC;IAC1B,CAAC;IAEO,oCAAW,GAAnB;QACI,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IACvE,CAAC;IAEO,uCAAc,GAAtB;QACI,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,CAAC;QACpB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;QAC9B,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IAC3B,CAAC;IAEO,yCAAgB,GAAxB,UAAyB,YAAoB;QACzC,IAAI,YAAY,EAAE,EAAE;YAChB,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;SAC/B;aACI;YACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;SACrC;IACL,CAAC;IACL,qBAAC;AAAD,CAAC;AA7GY,wCAAc;AAiH3B,IAAM,GAAG,GAAiC,EAAE,CAAC;AAE7C,SAAgB,iBAAiB,CAAC,EAAU;IACxC,OAAO,GAAG,CAAC,EAAE,CAAC,CAAC;AACnB,CAAC;AAFD,8CAEC;AAGD,SAAgB,wBAAwB,CAAC,UAAsB;IAC3D,IAAM,IAAI,GAAoB,EAAE,CAAC;IACjC,IAAI,UAAU,CAAC,EAAE,EAAE;QACf,IAAI,CAAC,EAAE,GAAG,UAAU,CAAC,EAAE,CAAC;KAC3B;IACD,IAAI,UAAU,CAAC,QAAQ,EAAE;QACrB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;QACnB,KAAkB,UAAmB,EAAnB,eAAU,CAAC,QAAQ,EAAnB,cAAmB,EAAnB,IAAmB,EAAE;YAAlC,IAAI,KAAK;YACV,IAAM,SAAS,GAAG,wBAAwB,CAAC,KAAK,CAAC,CAAC;YAClD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;SACjC;KACJ;IACD,IAAI,UAAU,CAAC,QAAQ,EAAE;QACrB,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;QAClB,KAAmB,UAAmB,EAAnB,eAAU,CAAC,QAAQ,EAAnB,cAAmB,EAAnB,IAAmB,EAAE;YAAnC,IAAI,MAAM;YACX,IAAM,UAAU,GAAG,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC;YAC3C,IAAI,UAAU,KAAK,eAAe,EAAE;gBAChC,SAAS;aACZ;YACD,IAAM,aAAa,GAAG;gBAClB,UAAU,EAAE,MAAM,CAAC,WAAW,CAAC,IAAI;aACtC,CAAC;YACF,IAAM,gBAAgB,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,gBAAgB,CAAC;YAC9D,IAAI,gBAAgB,EAAE;gBAClB,KAAiB,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB,EAAE;oBAA9B,IAAI,IAAI;oBACT,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBAC9C;aACJ;YACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;SAEpC;KACJ;IACD,OAAO,IAAI,CAAC;AAChB,CAAC;AAjCD,4DAiCC;AAED,SAAgB,gBAAgB,CAAC,IAAqB;IAElD,IAAM,UAAU,GAAG,IAAI,UAAU,EAAE,CAAC;IACpC,IAAI,IAAI,CAAC,EAAE,EAAE;QACT,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC;QAC1B,UAAU,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;KAC3B;IACD,IAAI,IAAI,CAAC,QAAQ,EAAE;QACf,KAAsB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;YAAhC,IAAI,SAAS;YACd,IAAM,KAAK,GAAG,gBAAgB,CAAC,SAAS,CAAC,CAAC;YAC1C,IAAI,KAAK,EAAE;gBACP,UAAU,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;aAC9B;SACJ;KACJ;IACD,IAAI,IAAI,CAAC,OAAO,EAAE;QACd,KAAuB,UAAY,EAAZ,SAAI,CAAC,OAAO,EAAZ,cAAY,EAAZ,IAAY,EAAE;YAAhC,IAAI,UAAU;YACf,IAAM,MAAM,GAAG,YAAY,CAAC,UAAU,CAAC,CAAC;YACxC,IAAM,gBAAgB,GAAG,MAAM,CAAC,WAAW,CAAC,CAAC,gBAAgB;YAC7D,IAAI,gBAAgB,EAAE;gBAClB,KAAiB,UAAgB,EAAhB,qCAAgB,EAAhB,8BAAgB,EAAhB,IAAgB,EAAE;oBAA9B,IAAI,IAAI;oBACT,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBAC3C;aACJ;YACD,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SAChC;KACJ;IACD,OAAO,UAAU,CAAC;AACtB,CAAC;AA5BD,4CA4BC;AAGD,IAAI,SAAS,GAAG,EAEf;AAED;;GAEG;AACH,SAAgB,cAAc,CAAC,WAA6B;IACxD,SAAS,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,WAAW;AAC7C,CAAC;AAFD,wCAEC;AAED,SAAgB,cAAc;IAC1B,IAAM,MAAM,GAAG,EAAE,CAAC;IAClB,KAAK,IAAI,GAAG,IAAI,SAAS,EAAE;QACvB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KACpB;IACD,OAAO,MAAM,CAAC;AAClB,CAAC;AAND,wCAMC;AAED,SAAgB,YAAY,CAAC,IAAS;IAClC,IAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;IACnC,IAAM,GAAG,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC;IAClC,IAAM,MAAM,GAAG,IAAI,GAAG,EAAE,CAAC;IACzB,OAAO,MAAM,CAAC;AAClB,CAAC;AALD,oCAKC;AAED,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC;AAC/B;IAA+B,6BAAS;IAAxC;QAAA,qEAgCC;QA7BG,OAAC,GAAW,CAAC,CAAC;QAGd,OAAC,GAAW,CAAC,CAAC;QAEd,YAAM,GAAW,CAAC,CAAC;QACnB,YAAM,GAAW,CAAC,CAAC;QAGnB,cAAQ,GAAW,CAAC,CAAC;QAErB,iBAAW,GAAW,IAAI,aAAM,EAAE,CAAC;QACnC,kBAAY,GAAW,IAAI,aAAM,EAAE,CAAC;;IAiBxC,CAAC;IAfG,2BAAO,GAAP;IACA,CAAC;IAED,kCAAc,GAAd;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;IACpB,CAAC;IAED,4BAAQ,GAAR;QACI,IAAI,CAAC,WAAW,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAClG,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC;QACzC,IAAI,MAAM,EAAE;YACR,IAAM,eAAe,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;YACvE,IAAI,CAAC,YAAY,GAAG,yBAAkB,CAAC,IAAI,CAAC,WAAW,EAAE,eAAe,CAAC,YAAY,CAAC,CAAC;SAC1F;IACL,CAAC;IA5BD;QADC,qBAAa,CAAC,6BAAqB,CAAC;wCACvB;IAGd;QADC,qBAAa,CAAC,6BAAqB,CAAC;wCACvB;IAMd;QADC,qBAAa,CAAC,6BAAqB,CAAC;+CAChB;IAoBzB,gBAAC;CAAA,CAhC8B,SAAS,GAgCvC;AAhCY,8BAAS;AAkCtB,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC;AAE9B;IAAmC,iCAAS;IAA5C;QAAA,qEAsDC;QA/CG,iBAAW,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC;;IA+C1D,CAAC;IA5CG,+BAAO,GAAP,UAAQ,WAAmB,EAAE,WAAmB;QAC5C,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAI,CAAC,WAAW,GAAG,WAAW,CAAC;QAC/B,IAAM,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QACzC,IAAM,MAAM,GAAG,aAAa,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC;QACjD,KAAK,IAAI,CAAC,GAAG,MAAM,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YAC9B,IAAM,KAAK,GAAG,aAAa,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YACxC,IAAM,WAAW,GAAG,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,WAAW,CAAC;YAC3D,IAAM,iBAAiB,GAAG,mBAAY,CAAC,WAAW,CAAC,CAAC;YACpD,IAAM,eAAe,GAAG,IAAI,YAAK,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC;YAC5D,2CAA2C;YAC3C,IAAM,eAAe,GAAG,wBAAiB,CAAC,eAAe,EAAE,iBAAiB,CAAC,CAAC;YAC9E,IAAM,kBAAkB,GAAG,KAAK,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;YAC1D,IAAM,MAAM,GAAG,kBAAkB,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC;YAChF,IAAI,MAAM,EAAE;gBACR,OAAO,MAAM,CAAC;aACjB;SACJ;QAED,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC;QACjD,IAAI,UAAU,EAAE;YACZ,IAAM,UAAU,GAAG,UAAU,CAAC,aAAa,EAAE,CAAC;YAC9C,IAAI,UAAU,EAAE;gBACZ,IAAI,WAAW,IAAI,CAAC,IAAI,WAAW,IAAI,UAAU,CAAC,KAAK;oBACnD,WAAW,IAAI,CAAC,IAAI,WAAW,IAAI,UAAU,CAAC,MAAM,EAAE;oBACtD,OAAO,aAAa,CAAC;iBACxB;qBACI;oBACD,OAAO,IAAI,CAAC;iBACf;aACJ;YACD,OAAO,IAAI,CAAC;SACf;aACI;YACD,OAAO,IAAI,CAAC;SACf;IACL,CAAC;IAED,+BAAO,GAAP;IACA,CAAC;IAED,gCAAQ,GAAR;IACA,CAAC;IAEL,oBAAC;AAAD,CAAC,CAtDkC,SAAS,GAsD3C;AAtDY,sCAAa;AAwD1B,cAAc,CAAC,SAAS,CAAC,CAAC;AAC1B,cAAc,CAAC,aAAa,CAAC,CAAC;AAC9B,cAAc,CAAC,cAAc,CAAC,CAAC;AAC/B,cAAc,CAAC,YAAY,CAAC,CAAC;AAG7B,SAAgB,YAAY;IACxB,OAAO,sBAAW,EAAE,CAAC,YAAY,EAAE,CAAC;AACxC,CAAC;AAFD,oCAEC;AAED,MAAM,CAAC,WAAW,CAAC,GAAG,oBAAS,CAAC;AACnB,YAAI,GAAG,IAAI,cAAc,EAAE,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3qBzC,mEAAgC;AAChC,yEAAqD;AACrD,gEAAsC;AACtC,kFAAoK;AACpK,gEAA4D;AAC5D,6DAAqC;AACrC,yEAA4C;AAC5C,gEAA8B;AAC9B,gFAAuC;AACvC,0EAAmC;AACnC,0HAAmE;AACnE,iHAA6D;AAE7D;IAAuC,qCAAS;IAAhD;QAAA,qEAqEC;QAnEW,UAAI,GAA+B,EAAE,CAAC;QAEtC,YAAM,GAAW,CAAC,CAAC;QACnB,YAAM,GAAW,CAAC,CAAC;QAEnB,eAAS,GAAG,CAAC,CAAC;;IA8D1B,CAAC;IA1DG,mCAAO,GAAP;IACA,CAAC;IAED,4CAAgB,GAAhB,UAAiB,MAAc,EAAE,MAAc;QAC3C,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;QAC1D,SAAS,CAAC,CAAC,GAAG,MAAM,CAAC;QACrB,SAAS,CAAC,CAAC,GAAG,MAAM,CAAC;IACzB,CAAC;IAED,gCAAI,GAAJ,UAAK,IAAgC;QACjC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,SAAS,GAAG,CAAC,CAAC;IAEvB,CAAC;IAED,oCAAQ,GAAR;QACI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE;YAC5B,OAAO;SACV;QACD,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;QAE1D,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5C,IAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QAC5C,IAAI,SAAS,CAAC,CAAC,KAAK,OAAO,EAAE;YACzB,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;aACI,IAAI,SAAS,CAAC,CAAC,GAAG,OAAO,EAAE;YAC5B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;aACI;YACD,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SACpB;QACD,IAAI,SAAS,CAAC,CAAC,KAAK,OAAO,EAAE;YACzB,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;aACI,IAAI,SAAS,CAAC,CAAC,GAAG,OAAO,EAAE;YAC5B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;SACnB;aACI;YACD,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;SACpB;QAGD,IAAM,mBAAmB,GAAG,SAAS,CAAC,CAAC,KAAK,OAAO,IAAI,SAAS,CAAC,CAAC,KAAK,OAAO,CAAC;QAC/E,IAAI,mBAAmB,EAAE;YACrB,IAAI,CAAC,SAAS,EAAE,CAAC;YACjB,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACpC,IAAI,IAAI,CAAC,UAAU,EAAE;oBACjB,IAAI,CAAC,UAAU,EAAE,CAAC;iBACrB;aACJ;SACJ;QAGD,SAAS,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC;QAC3B,SAAS,CAAC,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC;IAC/B,CAAC;IAEL,wBAAC;AAAD,CAAC,CArEsC,sBAAS,GAqE/C;AArEY,8CAAiB;AAwE9B;IAA0B,+BAAW;IAKjC,qBAAY,QAA2B,EAAE,KAAa,EAAE,KAAa;QAArE,YACI,iBAAO,SAIV;QAHG,KAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;;IACvB,CAAC;IAED,6BAAO,GAAP;QAAA,iBAyBC;QAvBG,IAAM,QAAQ,GAAG,IAAI,aAAK,CAAC,QAAQ,EAAE,CAAC;QACtC,IAAM,OAAO,GAAG,8BAAiB,CAAC,SAAS,CAAC,CAAC;QAC7C,IAAM,IAAI,GAAG,OAAO,CAAC,SAAS,CAAC,yBAAe,CAAC,CAAC,IAAI,CAAC;QACrD,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QAC3C,IAAM,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;QACnE,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QAC5C,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QAE5C,IAAM,KAAK,GAAG,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QAC9E,IAAI,KAAK,EAAE;YACP,IAAM,IAAI,GAAG,KAAK,CAAC,GAAG,CAAC,cAAI;gBACvB,OAAO,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE;YAC7C,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,IAAI,CAAC,QAAQ,CAAC,UAAU,GAAG;gBACvB,KAAI,CAAC,UAAU,EAAE,CAAC;YACtB,CAAC;YACD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SAC5B;aACI;YACD,IAAI,CAAC,UAAU,EAAE,CAAC;SACrB;IAEL,CAAC;IAED,4BAAM,GAAN;QACI,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC;IACvB,CAAC;IACL,kBAAC;AAAD,CAAC,CA1CyB,qBAAW,GA0CpC;AAED;IAA0B,+BAAW;IAArC;;IAkBA,CAAC;IAhBG,6BAAO,GAAP;QAAA,iBASC;QARG,IAAM,EAAE,GAAG,iBAAI,CAAC,YAAY,CAAC,mBAAY,CAAC,CAAC;QAC3C,IAAM,MAAM,GAAG,8BAAiB,CAAC,QAAQ,CAAC,CAAC;QAC3C,MAAM,CAAC,SAAS,CAAC,0BAAa,CAAC,CAAC,OAAO,GAAG;YACtC,MAAM,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;YACvB,KAAI,CAAC,UAAU,EAAE,CAAC;QACtB,CAAC;QACD,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;QACpB,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;IACjB,CAAC;IAED,4BAAM,GAAN;QACI,IAAM,MAAM,GAAG,8BAAiB,CAAC,QAAQ,CAAC,CAAC;QAC3C,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAChC,CAAC;IAEL,kBAAC;AAAD,CAAC,CAlByB,qBAAW,GAkBpC;AAED;IAAuC,qCAAS;IAAhD;QAAA,qEA8CC;QA5CW,iBAAW,GAAG,IAAI,qBAAW,EAAE,CAAC;;IA4C5C,CAAC;IAzCW,gCAAI,GAAZ,UAAa,KAAa,EAAE,KAAa;QACrC,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,iBAAiB,CAAC;QAChE,IAAM,YAAY,GAAG,IAAI,WAAW,CAAC,QAAQ,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QAC7D,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAIpC,IAAM,SAAS,GAAG,8BAAiB,CAAC,WAAW,CAAC,CAAC;QACjD,IAAM,kBAAkB,GAAG,SAAS,CAAC,SAAS,CAAC,yBAAkB,CAAC,CAAC;QACnE,IAAM,IAAI,GAAG,kBAAkB,CAAC,eAAe,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC9D,IAAI,IAAI,EAAE;YACN,IAAM,cAAc,GAAG,IAAI,qBAAc,CAAC,IAAI,CAAC,CAAC;YAChD,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;SACzC;aACI;YACD,IAAM,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;YACtC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;SACtC;QAED,wDAAwD;QAExD,sCAAsC;QAEtC,uCAAuC;QACvC,IAAI,CAAC,WAAW,CAAC,uBAAuB,EAAE,CAAC;IAE/C,CAAC;IAED,mCAAO,GAAP;QAAA,iBASC;QARG,IAAM,OAAO,GAAG,8BAAiB,CAAC,SAAS,CAAC,CAAC;QAC7C,IAAM,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,0BAAa,CAAC,CAAC;QACjD,OAAO,CAAC,OAAO,GAAG,UAAC,MAAM,EAAE,MAAM;YAC7B,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;YACtC,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;YACtC,KAAI,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;QAC5B,CAAC;IAEL,CAAC;IACD,oCAAQ,GAAR;IAEA,CAAC;IACL,wBAAC;AAAD,CAAC,CA9CsC,sBAAS,GA8C/C;AA9CY,8CAAiB;AAkD9B;IAAoC,kCAAS;IAA7C;;IAQA,CAAC;IAPG,gCAAO,GAAP;IAEA,CAAC;IACD,iCAAQ,GAAR;QACI,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,yBAAY,CAAC,CAAC;QACxD,IAAI,CAAC,IAAI,GAAG,WAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;IACrC,CAAC;IACL,qBAAC;AAAD,CAAC,CARmC,sBAAS,GAQ5C;AARY,wCAAc;AAY3B,2BAAc,CAAC,yBAAe,CAAC,CAAC;AAChC,2BAAc,CAAC,iBAAiB,CAAC,CAAC;AAClC,2BAAc,CAAC,iBAAiB,CAAC,CAAC;AAClC,2BAAc,CAAC,kBAAY,CAAC,CAAC;AAC7B,2BAAc,CAAC,yBAAkB,CAAC,CAAC;AACnC,2BAAc,CAAC,cAAc,CAAC,CAAC;AAC/B,2BAAc,CAAC,eAAM,CAAC,CAAC;AACvB,2BAAc,CAAC,WAAI,CAAC,CAAC;AACrB,2BAAc,CAAC,2CAAoB,CAAC,CAAC;AACrC,2BAAc,CAAC,qCAAiB,CAAC,CAAC;AAElC,iBAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;AAClC,iBAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;AAClC,iBAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;AAC/B,iBAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;AAC/B,iBAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;AACnC,iBAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;AACnC,iBAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;AACnC,iBAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;AACnC,iBAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;AAGjC,iBAAI,CAAC,KAAK,EAAE,CAAC;AAEb,IAAI,CAAC,yBAAY,EAAE,EAAE;IACjB,iBAAI,CAAC,SAAS,CAAC,wBAAwB,CAAC;CAC3C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7OD,kFAAkI;AAClI,kFAAoC;AACpC,gEAAoC;AACpC,yEAAwC;AACxC,gEAA8B;AAC9B,sEAAsD;AAEtD;IAAwC,sCAAS;IAAjD;QAAA,qEAoDC;QAjDW,WAAK,GAAW,EAAE,CAAC;;IAiD/B,CAAC;IA7CG,oCAAO,GAAP;QAEI,IAAI,CAAC,yBAAY,EAAE,EAAE;YACjB,KAAqB,UAAa,EAAb,SAAI,CAAC,QAAQ,EAAb,cAAa,EAAb,IAAa,EAAE;gBAA/B,IAAI,QAAQ;gBACb,IAAM,cAAc,GAAG,iBAAI,CAAC,YAAY,CAAC,iBAAU,CAAC,CAAC;gBACrD,IAAM,SAAS,GAAG,cAAc,CAAC,SAAS,CAAC,sBAAS,CAAC,CAAC;gBACtD,IAAM,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC;gBAEzB,SAAS,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC;gBAC9B,SAAS,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC;gBAC9B,IAAI,QAAQ,SAAM,CAAC;gBACnB,IAAI,GAAG,IAAI,CAAC,EAAE;oBACV,QAAQ,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC,CAAC;iBAC9B;qBACI,IAAI,GAAG,IAAI,CAAC,EAAE;oBACf,QAAQ,GAAG,IAAI,QAAQ,CAAC,GAAG,CAAC,CAAC;iBAChC;gBACD,IAAI,QAAQ,EAAE;oBACV,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;oBACxB,QAAQ,CAAC,CAAC,GAAG,QAAQ,CAAC,CAAC,CAAC;oBACxB,QAAQ,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC;oBAC5B,QAAQ,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,CAAC;oBAC5B,IAAM,cAAc,GAAG,cAAc,CAAC,SAAS,CAAC,2BAAc,CAAC,CAAC;oBAChE,cAAc,CAAC,SAAS,GAAG,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC;oBACpD,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAC1B,QAAQ,CAAC,cAAc,GAAG,cAAc,CAAC;iBAC5C;gBACD,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,cAAc,CAAC,CAAC;aAC/C;SACJ;IAEL,CAAC;IAED,qCAAQ,GAAR;IACA,CAAC;IAED,4CAAe,GAAf,UAAgB,KAAa,EAAE,KAAa;QACxC,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,cAAI,IAAI,WAAI,CAAC,CAAC,KAAK,KAAK,IAAI,IAAI,CAAC,CAAC,KAAK,KAAK,EAApC,CAAoC,CAAC,CAAC;QAC7E,IAAI,MAAM,EAAE;YACR,OAAO,MAAM,CAAC;SACjB;aACI;YACD,OAAO,IAAI,CAAC;SACf;IACL,CAAC;IA9CD;QADC,0BAAa,CAAC,gCAAmB,CAAC;wDACX;IA+C5B,yBAAC;CAAA,CApDuC,sBAAS,GAoDhD;AApDY,gDAAkB;AAsD/B;IASI,cAAY,GAAW;QACnB,IAAI,CAAC,MAAM,GAAG,mBAAU,CAAC,IAAI,CAAC,gBAAM,IAAI,aAAM,CAAC,EAAE,KAAK,GAAG,EAAjB,CAAiB,CAAC,CAAC;IAC/D,CAAC;IAED;;OAEG;IACH,kBAAG,GAAH;QAEI,OAAO,KAAK,CAAC;IACjB,CAAC;IACL,WAAC;AAAD,CAAC;AApBqB,oBAAI;AAsB1B;IAA4B,0BAAI;IAAhC;;IAMA,CAAC;IAJG,oBAAG,GAAH;QACI,OAAO,CAAC,GAAG,CAAC,6BAAO,IAAI,CAAC,MAAM,CAAC,IAAM,CAAC,CAAC;QACvC,OAAO,IAAI,CAAC;IAChB,CAAC;IACL,aAAC;AAAD,CAAC,CAN2B,IAAI,GAM/B;AANY,wBAAM;AASnB;IAA8B,4BAAI;IAAlC;;IAMA,CAAC;IAJG,sBAAG,GAAH;QACI,WAAI,CAAC,IAAI,IAAI,GAAG,CAAC;QACjB,OAAO,IAAI,CAAC;IAChB,CAAC;IACL,eAAC;AAAD,CAAC,CAN6B,IAAI,GAMjC;AANY,4BAAQ;AASrB;IAAoC,kCAAW;IAG3C,wBAAY,IAAU;QAAtB,YACI,iBAAO,SAEV;QADG,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;;IACrB,CAAC;IAED,gCAAO,GAAP;QACI,IAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;QACtC,IAAI,aAAa,EAAE;YACf,IAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC;YAC5C,UAAU,CAAC,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;SAC7C;QAGD,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAED,+BAAM,GAAN;IAEA,CAAC;IACL,qBAAC;AAAD,CAAC,CAtBmC,qBAAW,GAsB9C;AAtBY,wCAAc;;;;;;;;;;;;;;ACnG3B;;;;GAIG;;AAGH;;GAEG;AACH;IAGI,eAAY,CAAS,EAAE,CAAS;QAC5B,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;IACf,CAAC;IACL,YAAC;AAAD,CAAC;AAPY,sBAAK;AASlB;;;GAGG;AACH,SAAgB,iBAAiB,CAAC,KAAY,EAAE,CAAS;IACrD,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;IAC7C,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,KAAK,CAAC,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC;IAC7C,OAAO,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;AAE3B,CAAC;AALD,8CAKC;AAED;;;GAGG;AACH,SAAgB,YAAY,CAAC,CAAS;IAGlC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACZ,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACZ,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACZ,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACZ,IAAI,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC;IACd,IAAI,EAAE,GAAG,CAAC,CAAC,EAAE,CAAC;IAEd,IAAI,WAAW,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IAChC,IAAI,MAAM,GAAG,IAAI,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1C,IAAI,WAAW,IAAI,CAAC,EAAE;QAClB,MAAM,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC;KAChC;IAED,WAAW,GAAG,CAAC,GAAG,WAAW,CAAC;IAC9B,IAAI,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,WAAW,CAAC;IACnC,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,WAAW,CAAC;IAChC,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,WAAW,CAAC;IAChC,CAAC,GAAG,MAAM,CAAC,CAAC,GAAG,CAAC,GAAG,WAAW,CAAC;IAC/B,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC;IAC/B,MAAM,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,GAAG,EAAE,CAAC,CAAC;IAC/B,OAAO,MAAM,CAAC;AAElB,CAAC;AAzBD,oCAyBC;AAED;;;GAGG;AACH,SAAgB,kBAAkB,CAAC,EAAU,EAAE,EAAU;IAErD,IAAI,MAAM,GAAG,IAAI,MAAM,EAAE,CAAC;IAC1B,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACrC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACrC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACrC,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IACrC,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;IAChD,MAAM,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;IAChD,OAAO,MAAM,CAAC;AAClB,CAAC;AAVD,gDAUC;AAED,IAAI,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC;AACjB,IAAI,MAAM,GAAG,EAAE,GAAG,CAAC,CAAC;AACpB,IAAI,KAAK,GAAG,EAAE,GAAG,MAAM,CAAC;AACxB,IAAI,KAAK,GAAG,EAAE,GAAG,CAAC,CAAC;AACnB,IAAI,UAAU,GAAW,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;AAMvC;IAEI,gBAAY,CAAa,EAAE,CAAa,EAAE,CAAa,EAAE,CAAa,EAAE,EAAc,EAAE,EAAc;QAA1F,yBAAa;QAAE,yBAAa;QAAE,yBAAa;QAAE,yBAAa;QAAE,2BAAc;QAAE,2BAAc;QAClG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;QACX,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;QACb,IAAI,CAAC,EAAE,GAAG,EAAE,CAAC;IACjB,CAAC;IAgBD;;OAEG;IACI,yBAAQ,GAAf;QACI,OAAO,KAAK,GAAG,IAAI,CAAC,CAAC,GAAG,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,MAAM,GAAG,IAAI,CAAC,CAAC,GAAG,OAAO,GAAG,IAAI,CAAC,EAAE,GAAG,OAAO,GAAG,IAAI,CAAC,EAAE,GAAG,GAAG,CAAC;IAC9H,CAAC;IAED;;OAEG;IACH,wCAAuB,GAAvB,UAAwB,CAAS,EAAE,CAAS,EAAE,MAAc,EAAE,MAAc,EAAE,QAAgB;QAE1F,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;QACZ,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC;QAEZ,IAAI,KAAK,EAAE,KAAK,CAAC;QACjB,KAAK,GAAG,KAAK,GAAG,QAAQ,GAAG,GAAG,GAAG,IAAI,CAAC,EAAE,CAAC;QAAA,CAAC;QAE1C,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,KAAK,IAAI,KAAK,CAAC,EAAE;YAClE,IAAI,CAAC,CAAC,GAAG,MAAM,CAAC;YAChB,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;YACpB,IAAI,CAAC,CAAC,GAAG,MAAM,CAAC;YAChB,OAAO;SACV;QAED,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACxB,IAAI,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACxB,IAAI,KAAK,IAAI,KAAK,EAAE;YAChB,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;YACpB,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;SACvB;aAAM;YACH,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;YAClC,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,MAAM,CAAC;SACrC;QACD,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,MAAM,CAAC;QACrB,IAAI,CAAC,CAAC,GAAG,CAAC,GAAG,MAAM,CAAC;IAExB,CAAC;IACL,aAAC;AAAD,CAAC;AA/DY,wBAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzFnB,kFAAgG;AAChG,wDAAsC;AAGtC;IAAkC,gCAAS;IAA3C;QAAA,qEA2BC;QAzBW,YAAM,GAA+B,EAAE,CAAC;;IAyBpD,CAAC;IAxBG,8BAAO,GAAP;QAAA,iBAoBC;QAnBG,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,oBAAiB,CAAC,CAAC;QACjE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,cAAI;YAC9B,OAAO;gBACH,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE;gBACd,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE;aACjB;QACL,CAAC,CAAC,CAAC,CAAC;QACJ,QAAQ,CAAC,UAAU,GAAG;YAClB,KAAI,CAAC,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;YACpC,OAAO,CAAC,GAAG,CAAC,KAAI,CAAC,MAAM,CAAC;YACxB,QAAQ,CAAC,IAAI,CAAC,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,cAAI;gBAC9B,OAAO;oBACH,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE;oBACd,CAAC,EAAE,IAAI,CAAC,CAAC,GAAG,EAAE;iBACjB;YACL,CAAC,CAAC,CAAC,CAAC;QACR,CAAC;QACD,mFAAmF;QACnF,6BAA6B;IACjC,CAAC;IACD,+BAAQ,GAAR;IAEA,CAAC;IAxBD;QADC,0BAAa,CAAC,gCAAmB,CAAC;gDACa;IAyBpD,mBAAC;CAAA,CA3BiC,sBAAS,GA2B1C;AA3BY,oCAAY;AA6BzB;IAAuC,qCAAS;IAAhD;QAAA,qEAgBC;QAbW,UAAI,GAAmB,EAAE,CAAC;;IAatC,CAAC;IAZG,kCAAM,GAAN,UAAO,GAAiB;QACpB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACxB,CAAC;IAED,0CAAc,GAAd,UAAe,KAAa,EAAE,KAAa;IAE3C,CAAC;IAED,mCAAO,GAAP;IACA,CAAC;IACD,oCAAQ,GAAR;IACA,CAAC;IACL,wBAAC;AAAD,CAAC,CAhBsC,sBAAS,GAgB/C;AAhBY,8CAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjC9B,IAAI,QAAkB,CAAC;AAEvB,SAAgB,WAAW;IACvB,IAAI,QAAQ,EAAE;QACV,OAAO,QAAQ,CAAC;KACnB;IACD,IAAI,MAAM,CAAC,QAAQ,CAAC,EAAE;QAClB,QAAQ,GAAG,IAAI,cAAc,EAAE,CAAC;KACnC;SACI;QACD,QAAQ,GAAG,IAAI,eAAe,EAAE,CAAC;KACpC;IACD,OAAO,QAAQ,CAAC;AACpB,CAAC;AAXD,kCAWC;AAED;IAAA;IAWA,CAAC;IAAD,eAAC;AAAD,CAAC;AAGD;IAA8B,mCAAQ;IAAtC;;IAsDA,CAAC;IAnDG,qCAAW,GAAX,UAAY,QAAQ;QAChB,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACpC,MAAM,CAAC,YAAY,GAAG,UAAC,CAAC;YACpB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC9C,IAAM,KAAK,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;gBAClC,IAAM,OAAK,GAAG,EAAE,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,UAAU,EAAE,IAAI,EAAC,YAAY,EAAC,CAAC;gBAC5G,QAAQ,CAAC,OAAK,CAAC;aAClB;YACD,CAAC,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC;QACD,oCAAoC;QACpC,sBAAsB;QACtB,IAAI;QACJ,MAAM,CAAC,UAAU,GAAG,UAAC,CAAC;YAClB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC9C,IAAM,KAAK,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC;gBAClC,IAAM,OAAK,GAAG,EAAE,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,MAAM,EAAE,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,UAAU,EAAE,IAAI,EAAC,UAAU,EAAC,CAAC;gBAC1G,QAAQ,CAAC,OAAK,CAAC;aAClB;YACD,CAAC,CAAC,cAAc,EAAE,CAAC;QACvB,CAAC;IACL,CAAC;IAGD,qCAAW,GAAX,UAAY,QAAa;QACrB,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;QACpC,MAAM,CAAC,OAAO,GAAG,UAAC,CAAC;YACf,IAAM,IAAI,GAAG,MAAM,CAAC,qBAAqB,EAAE,CAAC;YAC5C,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC;YACjD,IAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;YAChD,QAAQ,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;QAC7B,CAAC;IACL,CAAC;IAID,sCAAY,GAAZ;QACI,OAAO,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;IACxD,CAAC;IACD,uCAAa,GAAb;QACI,OAAO,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAsB,CAAC;IACtE,CAAC;IACD,kCAAQ,GAAR,UAAS,GAAW,EAAE,QAAkB;QACpC,IAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;QACjC,GAAG,CAAC,MAAM,GAAG;YACT,QAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;QAC/B,CAAC;QACD,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;QACrB,GAAG,CAAC,IAAI,EAAE,CAAC;IACf,CAAC;IAEL,sBAAC;AAAD,CAAC,CAtD6B,QAAQ,GAsDrC;AAED;IAA6B,kCAAQ;IAArC;QAAA,qEAmDC;QAjDW,WAAK,GAAW,CAAC,CAAC;;IAiD9B,CAAC;IA/CG,oCAAW,GAAX,UAAY,QAAQ;QAChB,EAAE,CAAC,YAAY,CAAC,UAAC,KAAK;YAClB,QAAQ,CAAC,KAAK,CAAC;QACnB,CAAC,CAAC,CAAC;QACH,EAAE,CAAC,WAAW,CAAC,UAAC,KAAK;YACjB,QAAQ,CAAC,KAAK,CAAC;QACnB,CAAC,CAAC;QACF,EAAE,CAAC,UAAU,CAAC,UAAC,KAAK;YAChB,QAAQ,CAAC,KAAK,CAAC;QACnB,CAAC,CAAC,CAAC;IACP,CAAC;IAED,oCAAW,GAAX,UAAY,QAAa;QAAzB,iBAQC;QAPG,EAAE,CAAC,YAAY,CAAC,gBAAM;YAClB,IAAM,KAAK,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;YAC/B,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,GAAG,KAAI,CAAC,KAAK,CAAC;YAC3C,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,GAAG,KAAI,CAAC,KAAK,CAAC;YAC3C,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,OAAO,EAAE,KAAI,CAAC,KAAK,CAAC,CAAC;YAC1C,QAAQ,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QAC/B,CAAC,CAAC;IACN,CAAC;IACD,qCAAY,GAAZ;QACI,OAAO,KAAK,CAAC;IACjB,CAAC;IACD,sCAAa,GAAb;QACI,IAAM,MAAM,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC;QAChC,IAAM,KAAK,GAAG,MAAM,CAAC,KAAK,CAAC;QAC3B,IAAM,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;QAC7B,IAAM,KAAK,GAAG,KAAK,GAAG,MAAM,CAAC;QAC7B,uBAAuB;QACvB,4CAA4C;QAC5C,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QAEnB,MAAM,CAAC,MAAM,GAAC,GAAG,CAAC;QAClB,MAAM,CAAC,KAAK,GAAC,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC;QAErC,IAAM,GAAG,GAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAClC,GAAG,CAAC,KAAK,CAAC,KAAK,GAAC,MAAM,CAAC,KAAK,EAAC,KAAK,GAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAEjD,OAAO,MAAM,CAAC;IAClB,CAAC;IACD,iCAAQ,GAAR,UAAS,GAAW,EAAE,QAAkB;QACpC,IAAM,EAAE,GAAG,EAAE,CAAC,oBAAoB,EAAE,CAAC;QACrC,IAAM,OAAO,GAAG,EAAE,CAAC,YAAY,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;QAC9C,QAAQ,CAAC,OAAO,CAAC,CAAC;IACtB,CAAC;IAEL,qBAAC;AAAD,CAAC,CAnD4B,QAAQ,GAmDpC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxID,mEAAgC;AAChC,kFAAiG;AACjG;IAAqC,mCAAmB;IAAxD;QAAA,qEA4CC;QAxCG,cAAQ,GAAe,EAAE,CAAC;;IAwC9B,CAAC;IApCG,iCAAO,GAAP;QACI,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,IAAI,CAAC;QACrC,IAAI,CAAC,IAAI,GAAG,IAAI,aAAK,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAEjC,KAAK,IAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,EAAE,EAAE;YAChE,IAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACpC,KAAK,IAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,EAAE;gBACtD,IAAM,QAAQ,GAAG,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC;gBACnD,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC;aACtD;SACJ;IACL,CAAC;IACD,kCAAQ,GAAR;IACA,CAAC;IAED,kCAAQ,GAAR,UAAS,OAAiC;QACtC,KAAK,IAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,QAAQ,EAAE,EAAE;YAChE,IAAM,GAAG,GAAG,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACpC,KAAK,IAAI,QAAQ,GAAG,CAAC,EAAE,QAAQ,GAAG,GAAG,CAAC,MAAM,EAAE,QAAQ,EAAE,EAAE;gBACtD,IAAM,IAAI,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC;gBAC3B,IAAM,QAAQ,GAAG,YAAU,IAAI,SAAM,CAAC;gBACtC,IAAM,KAAK,GAAG,qBAAQ,CAAC,QAAQ,CAAC,CAAC;gBACjC,OAAO,CAAC,SAAS,CAAC,KAAK,EAAE,QAAQ,GAAG,EAAE,EAAE,QAAQ,GAAG,EAAE,CAAC,CAAC;aAC1D;SACJ;IACL,CAAC;IAGD,uCAAa,GAAb;QACI,OAAO;YACH,CAAC,EAAE,CAAC;YACJ,CAAC,EAAE,CAAC;YACJ,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,EAAE;YAC7B,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,EAAE;SACjC;IACL,CAAC;IAvCD;QADC,0BAAa,CAAC,gCAAmB,CAAC;qDACT;IAwC9B,sBAAC;CAAA,CA5CoC,gCAAmB,GA4CvD;AA5CY,0CAAe;;;;;;;;;;;;;;;ACA5B;IAAA;QAEI,SAAI,GAAW,EAAE,CAAC;QAElB,SAAI,GAAW,GAAG,CAAC;QAEnB,QAAG,GAAW,EAAE,CAAC;QAEjB,UAAK,GAAU,CAAC,CAAC;IACrB,CAAC;IAAD,WAAC;AAAD,CAAC;AATY,oBAAI;AAYJ,YAAI,GAAG,IAAI,IAAI,EAAE,CAAC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","export namespace astar {\n\n    export class Node {\n\n        x: number;\n        y: number;\n        f: number;\n        g: number;\n        h: number;\n        walkable: boolean = true;\n        parent: Node;\n        costMultiplier: number = 1.0;\n        inPath: boolean = false;\n\n        constructor(x: number, y: number) {\n            this.x = x;\n            this.y = y;\n        }\n\n        toString() {\n            if (this.inPath) {\n                return \"国\"\n            }\n            else if (!this.walkable) {\n                return \"田\"\n            }\n            else {\n                return \"口\"\n            }\n        }\n    }\n\n\n    export class Grid {\n\n        private _nodes: Node[][];\n        private _numCols: number;\n        private _numRows: number;\n\n        constructor(numCols: number, numRows: number) {\n            this._numCols = numCols;\n            this._numRows = numRows;\n            this._nodes = [];\n            for (var i: number = 0; i < this._numCols; i++) {\n                this._nodes[i] = [];\n                for (var j: number = 0; j < this._numRows; j++) {\n                    this._nodes[i][j] = new Node(i, j);\n                }\n            }\n        }\n\n        clear() {\n            for (var i: number = 0; i < this._numCols; i++) {\n                for (var j: number = 0; j < this._numRows; j++) {\n                    const node = this._nodes[i][j];\n                    node.f = node.g = node.h = 0;\n                    node.inPath = false;\n                    node.parent = null;\n                }\n            }\n        }\n\n        public getNode(x: number, y: number): Node {\n            return this._nodes[x][y];\n        }\n\n        public setWalkable(x: number, y: number, value: boolean): void {\n            this._nodes[x][y].walkable = value;\n        }\n\n\n        public get numCols(): number {\n            return this._numCols;\n        }\n\n        public get numRows(): number {\n            return this._numRows;\n        }\n\n        public getNeighbors(node: Node): Node[] {\n            const result = [];\n            const startX = Math.max(0, node.x - 1);\n            const endX = Math.min(this.numCols - 1, node.x + 1);\n            const startY = Math.max(0, node.y - 1);\n            const endY = Math.min(this.numRows - 1, node.y + 1);\n            for (let i = startX; i <= endX; i++) {\n                for (var j = startY; j <= endY; j++) {\n                    result.push(this.getNode(i, j));\n                }\n            }\n            return result;\n        }\n\n        public toString() {\n\n            var result = \"\";\n\n            for (var y = 0; y < this._numRows; y++) {\n                for (var x = 0; x < this._numCols; x++) {\n                    result += this._nodes[x][y].toString();\n                }\n                result += \"\\n\"\n            }\n            return result;\n        }\n\n    }\n\n\n    const STRAIGHT_COST = 1;\n\n    const DIAG_COST = Math.SQRT2;\n\n    export class FindPath {\n\n        private _heuristic: Function;\n\n        manhattan(node: Node, endNode: Node): number {\n            const cost = Math.abs(node.x - endNode.x) * STRAIGHT_COST\n                + Math.abs(node.y + endNode.y) * STRAIGHT_COST;\n            return cost;\n        }\n\n        euclidian(node: Node, endNode: Node): number {\n            const dx = node.x - endNode.x;\n            const dy = node.y - endNode.y;\n            return Math.sqrt(dx * dx + dy * dy) * STRAIGHT_COST;\n        }\n\n\n        diagonal(node: Node, endNode: Node): number {\n            const dx = Math.abs(node.x - endNode.x);\n            const dy = Math.abs(node.y - endNode.y);\n            const diag = Math.min(dx, dy);\n            const straight = dx + dy;\n            return DIAG_COST * diag + STRAIGHT_COST * (straight - 2 * diag);\n        }\n\n        constructor() {\n\n        }\n\n        public setHeurisitic(heuristic: Function) {\n            this._heuristic = heuristic;\n        }\n\n        public findPath(grid: Grid, startX: number, startY: number, endX: number, endY: number): Node[] {\n            grid.clear();\n            const startNode = grid.getNode(startX, startY);\n            const endNode = grid.getNode(endX, endY);\n            startNode.g = 0;\n            startNode.h = this._heuristic(startNode, endNode);\n            startNode.f = startNode.g + startNode.h;\n            const openList = [];\n            const closedList = [];\n            let currentNode = startNode;\n            while (currentNode != endNode) {\n                const neighbors = grid.getNeighbors(currentNode);\n                for (let i = 0; i < neighbors.length; i++) {\n                    const testNode = neighbors[i];\n                    if (testNode == currentNode ||\n                        !testNode.walkable) {\n                        continue;\n                    }\n                    let cost = STRAIGHT_COST;\n                    if (!((currentNode.x == testNode.x) || (currentNode.y == testNode.y))) {\n                        cost = DIAG_COST;\n                    }\n                    const g = currentNode.g + cost * testNode.costMultiplier;\n                    const h = this._heuristic(testNode, endNode);\n                    const f = g + h;\n                    if (openList.indexOf(testNode) >= 0 || closedList.indexOf(testNode) >= 0) {\n                        if (testNode.f > f) {\n                            testNode.f = f;\n                            testNode.g = g;\n                            testNode.h = h;\n                            testNode.parent = currentNode;\n                        }\n                        else {\n                            //什么也不做\n                        }\n                    }\n                    else {\n                        testNode.f = f;\n                        testNode.g = g;\n                        testNode.h = h;\n                        testNode.parent = currentNode;\n                        openList.push(testNode);\n\n                    }\n                }\n                closedList.push(currentNode);\n\n                if (openList.length == 0) {\n                    console.log(\"no path found\");\n                    return null;\n                }\n                openList.sort((a, b) => a.f - b.f);\n                currentNode = openList.shift();\n            }\n            const path = [];\n            let nodeInPath = endNode;\n            path.push(nodeInPath);\n            nodeInPath.inPath = true;\n            while (nodeInPath != startNode) {\n                nodeInPath = nodeInPath.parent;\n                path.unshift(nodeInPath);\n                nodeInPath.inPath = true;\n            }\n            return path;\n        }\n    }\n}\n","export class CommandPool {\n\n\n    private _commandList: CommandBase[] = [];\n    private currentCommand: CommandBase = null;\n\n    push(command: CommandBase) {\n        if (this.currentCommand) {\n            this._commandList = [];\n            this.currentCommand.cancel();\n            this.currentCommand = null;\n        }\n        this._commandList.push(command);\n    }\n\n    seriesExecuteAllCommand() {\n        this.pickAndExecuteFirstCommand();\n    }\n\n    private pickAndExecuteFirstCommand() {\n        if (this.currentCommand) {\n            return;\n        }\n        if (this._commandList.length == 0) {\n            return;\n        }\n        const command = this._commandList.shift();\n        this.currentCommand = command;\n        command.onFinished = () => {\n            this.currentCommand = null;\n            this.pickAndExecuteFirstCommand();\n        }\n        command.execute();\n\n\n\n    }\n}\n\nexport abstract class CommandBase {\n\n\n    onFinished: () => void;\n\n    abstract execute(): void;\n\n    abstract cancel(): void;\n}","export type ItemConfigType = {\n    id: number,\n    name: string;\n    iconName: string;\n}\n\n\nexport const itemConfig: ItemConfigType[] = [\n    { id: 1, name: '小型治疗药水', iconName: \"assets/item1.png\" },\n    { id: 2, name: \"金币\", iconName: \"assets/item2.png\" }\n]","\nexport type Data_DisplayObject = {\n    scripts?: any[]\n    id?: string,\n    children?: Data_DisplayObject[]\n}\n\nexport const uiPrefabData: Data_DisplayObject = {\n    scripts: [\n        { scriptName: \"Transform\", x: 0, y: 0, rotation: 0 },\n        { scriptName: \"SpriteRenderer\", imageName: \"assets/font.png\" }\n    ],\n}\n\nexport const itemPrefab: Data_DisplayObject = {\n    scripts: [\n        { scriptName: \"Transform\", x: 0, y: 0, rotation: 0 },\n        {\n            scriptName: \"SpriteRenderer\"\n        },\n    ]\n}","import { core, getScriptsName, createScript } from \"./gameengine\";\nimport { GameObject, Behaviour, Transform, getGameObjectById, createDataFromGameObject } from \"./gameengine\";\n\nexport class EditorAPI {\n\n    private scriptsUUIDMap = {};\n\n    private listener: (data: any) => void;\n\n    addListener(listener: (data: any) => void) {\n        this.listener = listener;\n        this.nofityListener();\n    }\n\n    save() {\n\n        const jsonData = createDataFromGameObject(core.stage.children[0]);\n        const content = JSON.stringify(jsonData, null, '\\t');\n        return content;\n\n    }\n\n    addGameObject(){\n        const container = core.stage.children[0];\n        const gameObject = new GameObject();\n        const transform = new Transform();\n        gameObject.addScript(transform);\n        container.addChild(gameObject);\n    }\n\n    addScript(gameObjectUUID:string,scriptName:string){\n        const container = core.stage.children[0];\n        const script = createScript({scriptName:scriptName})\n        container.addScript(script);\n    }\n\n    getScriptsList(){\n        return getScriptsName();\n    }\n\n    setScriptProperty(scriptUUID: string, property: { name: string, value: any }) {\n        const script = this.scriptsUUIDMap[scriptUUID];\n        script[property.name] = property.value;\n    }\n\n    nofityListener() {\n        if (this.listener) {\n            const result = this.getInfo();\n            console.log(result)\n            this.listener(result);\n        }\n    }\n\n    currentSceneFilePath:string;\n\n    changeScene(sceneUrl:string) {\n        this.currentSceneFilePath = sceneUrl;\n        core.loadScene(sceneUrl);\n    }\n\n\n    private getInfo() {\n        const scriptsUUIDMap = this.scriptsUUIDMap;\n        let gameObjectUUID = 0;\n        let scriptUUID = 0;\n        function getGameObjectInfo(gameObject: GameObject) {\n            gameObjectUUID++;\n            const name = gameObject.id ? gameObject.id +\".\"+ gameObjectUUID : \"Unnamed.\" + gameObjectUUID;\n            const children = gameObject.children.map(child => getGameObjectInfo(child));\n          \n            const scripts = gameObject._scripts.map(script => {\n                scriptUUID++;\n                scriptsUUIDMap[scriptUUID] = script;\n                const properties = []\n                const serilizeableKeys = script['__proto__'].serilizeableKeys;\n                if (serilizeableKeys) {\n                    for (let item of serilizeableKeys) {\n                        const property = {\n                            name: item.key,\n                            createPropertyEditor: (host) => {\n                                return item.propertyEditorFactory(host, script, item.key);\n                            }\n                        };\n                        properties.push(property)\n\n                    }\n                }\n\n\n                return {\n                    name: script.name, properties, uuId: scriptUUID\n                }\n            })\n            return { name, children, scripts,uuId:gameObjectUUID }\n        }\n        return getGameObjectInfo(core.stage);\n\n    }\n}\n\nexport const editorAPI = new EditorAPI();","import { Behaviour } from \"../gameengine\";\n\n\nconst FALL_TIME = 4000;\n\nconst MISTAKE_TIME = 1000;\n\n\ntype State =\"idle\" | \"waiting\" | \"touchable\" | \"touching-cannot-release\" | \"touching-can-release\" | \"touched-success\" | \"touched-fail\" | \"missing\";\n\nexport class Collider extends Behaviour {\n\n    appearTime: number = 0;\n\n\n    speedRate: number = 1;\n\n    sizeTime: number = 4000;\n\n    state: State = \"waiting\";\n    private duringTime = 0;\n\n    changeState(state: State) {\n        if (this.state != state) {\n            this.state = state;\n            this.onChangeState(state);\n        }\n    }\n\n    private onChangeState(to: State) {\n        console.log('碰撞体切换为', to)\n    }\n\n    protected onStart() {\n\n    }\n\n    protected onUpdate(advancedTime: number) {\n        this.duringTime += advancedTime;\n        if (this.state === 'waiting') {\n            if (this.duringTime >= this.appearTime + FALL_TIME) {\n                this.changeState(\"touchable\")\n            }\n        }\n        else if (this.state === 'touchable') {\n            if (this.duringTime >= this.appearTime + FALL_TIME + MISTAKE_TIME) {\n                this.changeState(\"missing\");\n            }\n        }\n        else if (this.state === 'touching-cannot-release') {\n            if (this.duringTime >= this.appearTime + FALL_TIME + this.sizeTime) {\n                this.changeState('touching-can-release')\n            }\n        }\n    }\n\n    isMatch(time: number) {\n        if (time >= this.appearTime + FALL_TIME &&\n            time <= this.appearTime + FALL_TIME + MISTAKE_TIME\n        ) {\n            console.log('match!!!!')\n            return true;\n        }\n        {\n            return false;\n        }\n\n    }\n\n\n\n}","import { Behaviour, GameObject } from \"../gameengine\";\nimport { user } from \"../user\";\nimport { createContainer } from \"./utils\";\nimport { getPlatform } from \"../platform\";\nimport { Collider } from \"./Collider\";\n\ntype State = \"up\" | \"down\";\n\nexport class GamePlayBehaviour extends Behaviour {\n\n    private duringTime = 0;\n\n\n    private state:State = \"up\";\n\n\n    private currentTouchId:number = -1;\n\n    private gameObjects:GameObject[] = [];\n\n    protected onStart() {\n\n\n        const gameObject = createContainer();\n        const collider = new Collider();\n        gameObject.addScript(collider);\n        this.gameObjects.push(gameObject);\n        this.displayObject.addChild(gameObject);\n\n        getPlatform().listenTouch((event)=>{\n            if (event.type === 'touchstart'){\n                if (this.currentTouchId == -1){\n                    this.changeState(\"down\");\n                    this.currentTouchId = event.touchId;\n                }\n              \n            }\n            else if (event.type === 'touchend'){\n                if (this.currentTouchId === event.touchId){\n                    this.changeState(\"up\");\n                    this.currentTouchId = -1;\n                }\n            }\n            \n        })\n\n    \n      \n    } \n\n    private onStateChanged(to:State){\n        console.log('按键切换为',to)\n        const gameObjects = this.gameObjects;\n        const first = gameObjects[0].getScript(Collider);\n        if (to === 'down'){\n           \n            if (first.state === 'waiting'){\n                console.log('什么也没发生');\n            }\n            else if (first.state === 'touchable'){\n                first.changeState('touching-cannot-release')\n            }\n        }\n        else if (to ==='up'){\n            if (first.state === \"touching-cannot-release\"){\n                first.changeState('touched-fail')\n            }\n            else if (first.state === 'touching-can-release'){\n                first.changeState('touched-success');\n            }\n        }\n    }\n    \n    private changeState(state:State ){\n        if (this.state != state){\n            this.state = state;\n            this.onStateChanged(state);\n        }\n    }\n\n     protected onUpdate(advancedTime: number) {\n       \n        this.duringTime += advancedTime;\n        user.score  = this.duringTime\n    }\n\n\n\n}","import { Behaviour, core } from \"../gameengine\";\nimport { Slider } from \"./Slider\";\nimport { createBitmap } from \"./utils\";\n\nexport class Menu extends Behaviour {\n    onStart() {\n\n        const slider = this.displayObject.getScript(Slider);\n        slider.onCreateItemRenderer = (data)=>{\n            return createBitmap(data.imageName);\n        }\n        slider.datas = [\n            {imageName:'assets/item1.png'},\n            {imageName:'assets/item1.png'},\n            {imageName:'assets/item1.png'}\n        ]\n        slider.onSelect = (data)=>{\n            core.loadScene(\"assets/main.scene.json\")\n        }\n        slider.iconWidth = slider.iconHeight = 64;\n    } \n    \n    onUpdate(advancedTime: number) {\n\n    }\n\n\n\n}","import { Behaviour, Transform } from \"../gameengine\";\n\nexport class MoveBehaviour extends Behaviour {\n\n    duration:number = 500;\n\n    targetY:number = 0;\n\n    private duringTime = 0;\n\n    private startY:number = 0;\n\n    onStart(){\n        const transform = this.displayObject.getScript(Transform);\n        this.startY =  transform.y;\n    }\n\n    onUpdate(advancedTime:number){\n\n        function ease(x:number){\n            return -(x -1)*(x-1) + 1;\n        }\n\n        this.duringTime += advancedTime;\n\n        let timeRate = this.duringTime / this.duration;\n       \n        if (timeRate > 1) {\n            timeRate = 1;\n        }\n        timeRate = ease(timeRate)\n        const transform = this.displayObject.getScript(Transform);\n        transform.y = this.targetY * timeRate + this.startY;\n\n        if (timeRate >= 1){\n            this.displayObject.removeScript(this);\n        }\n    }\n}","import { Behaviour, ClipRenderer, HitTestScript, propertyEditor_Number, SerilizeField, Transform, GameObject } from \"../gameengine\";\nimport { MoveBehaviour } from \"./MoveBehaviour\";\nimport { createBitmap, createContainer } from \"./utils\";\n\nexport class Slider extends Behaviour {\n\n    @SerilizeField(propertyEditor_Number)\n    contentWidth: number = 0;\n    @SerilizeField(propertyEditor_Number)\n    contentHeight: number = 0;\n\n    datas:any[];\n\n    iconWidth:number;\n    iconHeight:number;\n\n\n    onSelect:(data:any)=>void;\n\n    onCreateItemRenderer:(data:any)=>GameObject;\n\n\n    onStart() {\n        const container = createContainer();\n        const clipRenderer = new ClipRenderer();\n        clipRenderer.contentWidth = this.contentWidth;\n        clipRenderer.contentHeight = this.contentHeight;\n        this.displayObject.addScript(clipRenderer);\n\n        this.displayObject.addChild(container);\n        const iconX = (this.contentWidth - this.iconWidth) / 2;\n        const iconY = (this.contentHeight - this.iconHeight) / 2;\n\n        let index = 0;\n        for (let icon of this.datas) {\n            const iconGameObject = this.onCreateItemRenderer(icon); \n            const iconTransform = iconGameObject.getScript(Transform);\n            iconTransform.x = iconX;\n            iconTransform.y = iconY + this.contentHeight * index\n            container.addChild(iconGameObject);\n            const hitTest = iconGameObject.getScript(HitTestScript);\n            hitTest.onClick = ()=>{\n                if (this.onSelect){\n                    this.onSelect(icon);\n                }\n                return true;\n            }\n            index++;\n        }\n\n        const hitTest = this.displayObject.getScript(HitTestScript);\n        hitTest.onClick = () => {\n            const move = new MoveBehaviour();\n            move.targetY = -this.contentHeight\n            container.addScript(move);\n        }\n    }\n\n\n\n    onUpdate() { }\n\n\n\n}","import { Behaviour, TextRenderer } from \"../gameengine\";\nimport { user } from \"../user\";\n\nexport class UpdateScoreBehaviour extends Behaviour {\n\n    protected onStart() {\n\n    }\n\n    protected onUpdate(advancedTime: number) {\n        const text = this.displayObject.getScript(TextRenderer);\n        text.text = user.score.toString();\n    }\n\n\n}","import { GameObject, Transform, SpriteRenderer } from \"../gameengine\";\n\nexport function createBitmap(url:string){\n    const gameObject = new GameObject();\n    const transform = new Transform();\n    gameObject.addScript(transform);\n    const spriteRenderer = new SpriteRenderer();\n    gameObject.addScript(spriteRenderer);\n    spriteRenderer.imageName = url;\n    return gameObject;\n}\n\nexport function createContainer(){\n    const gameObject = new GameObject();\n    const transform = new Transform();\n    gameObject.addScript(transform);\n    return gameObject;\n}","import { Data_DisplayObject as Data_GameObject } from \"./data\";\nimport { editorAPI } from \"./editmode\";\nimport { invertMatrix, Matrix, matrixAppendMatrix, Point, pointAppendMatrix } from \"./math\";\nimport { getPlatform } from \"./platform\";\n\n// https://www.w3cschool.cn/html5/q2ybmfle.html\n\n// 如何实现可复用？ -> 使用组合，而不是继承\n\nconst cost: MethodDecorator = (target, key, desc: any) => {\n    const method = desc.value;\n    console.log('装饰器!!!!!')\n    desc.value = function () {\n        const startTime = Date.now();\n        const result = method.apply(this, arguments);\n        const endTime = Date.now();\n        const cost = endTime - startTime;\n        console.log('执行开销', cost);\n        return result;\n    }\n}\n\nfunction createEditorObject(key, value) {\n    const obj = {};\n    obj[key] = value;\n    return obj;\n}\n\nexport const propertyEditor_Number: PropertyEditorFactory = (host, script, key) => {\n\n    const value = script[key];\n    const obj = createEditorObject(key, value)\n    const controller = host.scriptRoot.add(obj, key).step(1)\n    controller.onChange(function (value) {\n        host.save(key, value);\n    });\n\n    controller.onFinishChange(function (value) {\n        host.save(key, value);\n    });\n};\n\nexport const propertyEditor_String: PropertyEditorFactory = (host, script, key) => {\n    const value = script[key];\n    const obj = createEditorObject(key, value)\n    const controller = host.scriptRoot.add(obj, key);\n    controller.onChange(function (value) {\n        host.save(key, value);\n    });\n\n    controller.onFinishChange(function (value) {\n        host.save(key, value);\n    });\n}\n\nexport const propertyEditor_None: PropertyEditorFactory = (host, script, key) => {\n    host.scriptRoot.addFolder(key)\n}\n\n\ninterface PropertyEditorHost {\n\n    /**\n     * 通知编辑器保存该属性\n     */\n    save: (name: string, value: any) => void\n\n    /**\n     * 编辑器的脚本UI扩展口\n     */\n    scriptRoot: any;\n\n}\n\ntype PropertyEditorFactory = (\n    host: PropertyEditorHost,\n    script: Behaviour,\n    key: string) => void\n\n\nexport const SerilizeField = (propertyEditorFactory: PropertyEditorFactory) => (target, key) => {\n\n\n    const clz = target as any;\n    if (!clz.serilizeableKeys) {\n        clz.serilizeableKeys = [];\n    }\n\n\n    clz.serilizeableKeys.push({\n        key, propertyEditorFactory\n    });\n}\n\nexport abstract class Behaviour {\n\n    constructor() {\n        this.name = this.constructor.name;\n    }\n\n    name: string;\n\n    displayObject: GameObject;\n\n    isStart:boolean = false;\n\n    protected abstract onStart();\n\n    onEnd() {\n\n    }\n\n    onEditorUpdate() {\n    }\n    \n\n    editorUpdate(){\n        if (!this.isStart){\n            this.isStart = true;\n            this.onStart();\n        }\n        this.onEditorUpdate();\n    }\n\n    update(advancedTime:number){\n        if (!this.isStart){\n            this.isStart = true;\n            this.onStart();\n        }\n        this.onUpdate(advancedTime);\n    }\n\n    protected abstract onUpdate(advancedTime: number);\n\n}\n\nexport abstract class RenderableBehaviour extends Behaviour {\n\n    onRender(context: CanvasRenderingContext2D) {\n\n    }\n\n    onAfterRender(context: CanvasRenderingContext2D) {\n\n    }\n\n    getRenderArea(): { x: number, y: number, width: number, height: number } {\n        return null;\n    }\n\n}\n\nexport class TouchInput {\n\n\n}\n\n\nexport class GameObject {\n\n\n    id: string;\n\n    alpha: number = 1;\n\n    private globalAlpha: number = 1;\n\n    parent: GameObject;\n\n    private isStage: boolean = false;\n\n    children: GameObject[] = [];\n\n    renderNode: RenderableBehaviour;\n\n\n\n    constructor(isStage: boolean = false) {\n        this.isStage = isStage;\n        const hitTestScript = new HitTestScript();\n        this.addScript(hitTestScript);\n    }\n\n    addChild(displayObject: GameObject) {\n        this.children.push(displayObject);\n        displayObject.parent = this;\n        editorAPI.nofityListener();\n    }\n\n    removeChild(displayObject: GameObject) {\n        const index = this.children.indexOf(displayObject);\n        this.children.splice(index, 1);\n        editorAPI.nofityListener();\n    }\n\n\n    _scripts: Behaviour[] = [];\n\n    addScript(script: Behaviour) {\n        script.displayObject = this;\n        this._scripts.push(script);\n    }\n\n    removeScript(script: Behaviour) {\n        const index = this._scripts.indexOf(script);\n        if (index >= 0) {\n            this._scripts.splice(index);\n            script.onEnd();\n        }\n    }\n\n    /**\n     * T 是一个泛型\n     */\n    getScript<T extends Behaviour>(clz: { new(): T }): T {\n        for (let script of this._scripts) {\n            if (script.constructor === clz) {\n                return script as T;\n            }\n        }\n        return null;\n    }\n\n\n    onUpdate(advancedTime: number) {\n        for (let script of this._scripts) {\n            script.update(advancedTime);\n        }\n        for (let child of this.children) {\n            child.onUpdate(advancedTime);\n        }\n    }\n\n    onEditorUpdate() {\n        for (let script of this._scripts) {\n            script.editorUpdate();\n        }\n        for (let child of this.children) {\n            child.onEditorUpdate();\n        }\n    }\n\n    draw(context: CanvasRenderingContext2D) {\n        const globalMatrix = this.getScript(Transform).globalMatrix\n        if (!this.isStage) {\n            this.globalAlpha = this.alpha * this.parent.globalAlpha;\n        }\n        context.globalAlpha = this.globalAlpha;\n        context.setTransform(\n            globalMatrix.a,\n            globalMatrix.b,\n            globalMatrix.c,\n            globalMatrix.d,\n            globalMatrix.tx,\n            globalMatrix.ty\n        )\n        if (this.renderNode) {\n            this.renderNode.onRender(context);\n        }\n        for (let child of this.children) {\n            child.draw(context);\n        }\n        if (this.renderNode) {\n            this.renderNode.onAfterRender(context);\n        }\n    }\n}\n\nexport class ClipRenderer extends RenderableBehaviour {\n    \n     contentWidth:number = 0;\n     contentHeight:number = 0;\n    \n    onStart() {\n        this.displayObject.renderNode = this;\n    }\n    onUpdate(advancedTime: number) {\n\n    }\n\n    getRenderArea() {\n        return { x: 0, y: 0, width: this.contentWidth, height: this.contentHeight }\n    }\n\n    onRender(context: CanvasRenderingContext2D) {\n        context.save();\n        context.rect(0, 0, this.contentWidth, this.contentHeight);\n        context.clip();\n    }\n\n    onAfterRender(context: CanvasRenderingContext2D) {\n        context.restore();\n    }\n\n\n}\n\n\nexport class SpriteRenderer extends RenderableBehaviour {\n\n    @SerilizeField(propertyEditor_String)\n    imageName: string;\n\n    onStart() {\n        this.displayObject.renderNode = this;\n    }\n\n    onUpdate() {\n    }\n\n    onRender(context: CanvasRenderingContext2D) {\n        if (this.imageName) {\n            const image = getImage(this.imageName);\n            context.drawImage(image, 0, 0);\n        }\n    }\n\n    getRenderArea() {\n        if (this.imageName) {\n            const image = getImage(this.imageName);\n            return { x: 0, y: 0, width: image.width, height: image.height }\n        }\n        return null;\n    }\n\n}\n\n\nexport class TextRenderer extends RenderableBehaviour {\n\n\n    @SerilizeField(propertyEditor_String)\n    text: string = \"\";\n\n    @SerilizeField(propertyEditor_Number)\n    fontSize: number = 24;\n\n    onStart() {\n        this.displayObject.renderNode = this;\n    }\n\n    onUpdate() {\n\n    }\n\n    onRender(context: CanvasRenderingContext2D) {\n        const lines = this.text.split(\"\\n\");\n        context.font = this.fontSize + 'px Arial'\n        context.fillStyle = '#FF0000';\n        let lineCount = 0;\n        for (let line of lines) {\n            lineCount++;\n            context.fillText(line, 0, this.fontSize * lineCount);\n        }\n    }\n\n    getRenderArea() {\n        return { x: 0, y: 0, width: 100, height: 20 };\n    }\n}\n\nconst images: { [url: string]: HTMLImageElement } = {};\n\nexport function getImage(url: string) {\n    return images[url];\n}\n\nexport class GameEngineCore {\n\n    private canvas: HTMLCanvasElement;\n    private context: CanvasRenderingContext2D;\n\n    stage = new GameObject(true);\n\n    constructor() {\n        this.canvas = getPlatform().getMainCanvas();\n        this.context = this.canvas.getContext(\"2d\");\n        this.stage.addScript(new Transform());\n    }\n\n\n\n\n    loadImage(url: string) {\n        const img = document.createElement(\"img\");\n        img.src = url;\n        images[url] = img;\n    }\n\n    private currentScene: GameObject;\n\n    loadScene(sceneUrl: string) {\n\n        getPlatform().loadText(sceneUrl, (text) => {\n            const json = JSON.parse(text);\n            this.createScene(json);\n        })\n\n\n    }\n\n    createScene(data: Data_GameObject) {\n        if (this.currentScene) {\n            this.stage.removeChild(this.currentScene);\n        }\n        const rootDisplayObject = createGameObject(data)\n        this.stage.addChild(rootDisplayObject);\n        this.currentScene = rootDisplayObject;\n    }\n\n    createPrefab(data: Data_GameObject) {\n        const gameObject = createGameObject(data);\n        return gameObject;\n    }\n\n    start() {\n        this.executeFrame(0);\n\n        getPlatform().listenClick((clickX: number, clickY: number) => {\n            const hitTestScript = this.stage.getScript(HitTestScript);\n            const hitTestDisplayObject = hitTestScript.hitTest(clickX, clickY)\n            let displayObject = hitTestDisplayObject;\n            while (displayObject) {\n                const hitTestScript = displayObject.getScript(HitTestScript);\n                if (hitTestScript && hitTestScript.onClick) {\n                    const isStop = hitTestScript.onClick(hitTestScript.clickLocalX, hitTestScript.clickLocalY);\n                    if (isStop){\n                        break;\n                    }\n                }\n                displayObject = displayObject.parent;\n            }\n        })\n    }\n\n    private lastTime: number = 0;\n\n    executeFrame(duringTime: number) {\n        const advancedTime = duringTime - this.lastTime;\n        this.lastTime = duringTime;\n        requestAnimationFrame(this.executeFrame.bind(this));\n        this.update(advancedTime);\n    }\n\n\n\n    /**\n     * 游戏引擎心跳控制\n     * - 清除屏幕\n     * - 执行用户逻辑\n     * - 执行渲染\n     */\n    update(advancedTime: number) {\n        this.clearScreen();\n        this.executeUserLogic(advancedTime);\n        this.drawRenderList();\n    }\n\n    private clearScreen() {\n        this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    }\n\n    private drawRenderList() {\n        this.context.save();\n        this.stage.draw(this.context);\n        this.context.restore();\n    }\n\n    private executeUserLogic(advancedTime: number) {\n        if (isEditorMode()) {\n            this.stage.onEditorUpdate();\n        }\n        else {\n            this.stage.onUpdate(advancedTime);\n        }\n    }\n}\n\n\n\nconst ids: { [id: string]: GameObject } = {};\n\nexport function getGameObjectById(id: string) {\n    return ids[id];\n}\n\n\nexport function createDataFromGameObject(gameObject: GameObject): Data_GameObject {\n    const json: Data_GameObject = {};\n    if (gameObject.id) {\n        json.id = gameObject.id;\n    }\n    if (gameObject.children) {\n        json.children = [];\n        for (let child of gameObject.children) {\n            const dataChild = createDataFromGameObject(child);\n            json.children.push(dataChild);\n        }\n    }\n    if (gameObject._scripts) {\n        json.scripts = [];\n        for (let script of gameObject._scripts) {\n            const scriptName = script.constructor.name;\n            if (scriptName === 'HitTestScript') {\n                continue;\n            }\n            const serilizedData = {\n                scriptName: script.constructor.name\n            };\n            const serilizeableKeys = script['__proto__'].serilizeableKeys;\n            if (serilizeableKeys) {\n                for (let item of serilizeableKeys) {\n                    serilizedData[item.key] = script[item.key];\n                }\n            }\n            json.scripts.push(serilizedData);\n\n        }\n    }\n    return json;\n}\n\nexport function createGameObject(data: Data_GameObject): GameObject {\n\n    const gameObject = new GameObject();\n    if (data.id) {\n        ids[data.id] = gameObject;\n        gameObject.id = data.id;\n    }\n    if (data.children) {\n        for (let childData of data.children) {\n            const child = createGameObject(childData);\n            if (child) {\n                gameObject.addChild(child);\n            }\n        }\n    }\n    if (data.scripts) {\n        for (let scriptData of data.scripts) {\n            const script = createScript(scriptData);\n            const serilizeableKeys = script['__proto__'].serilizeableKeys\n            if (serilizeableKeys) {\n                for (let item of serilizeableKeys) {\n                    script[item.key] = scriptData[item.key];\n                }\n            }\n            gameObject.addScript(script);\n        }\n    }\n    return gameObject;\n}\n\n\nlet scriptMap = {\n\n}\n\n/**\n * 里式替换法则\n */\nexport function registerScript(scriptClass: typeof Behaviour) {\n    scriptMap[scriptClass.name] = scriptClass\n}\n\nexport function getScriptsName() {\n    const result = [];\n    for (let key in scriptMap) {\n        result.push(key);\n    }\n    return result;\n}\n\nexport function createScript(data: any): Behaviour {\n    const scriptName = data.scriptName;\n    const clz = scriptMap[scriptName];\n    const script = new clz();\n    return script;\n}\n\nconsole.log('before Transform')\nexport class Transform extends Behaviour {\n\n    @SerilizeField(propertyEditor_Number)\n    x: number = 0;\n\n    @SerilizeField(propertyEditor_Number)\n    y: number = 0;\n\n    scaleX: number = 1;\n    scaleY: number = 1;\n\n    @SerilizeField(propertyEditor_Number)\n    rotation: number = 0;\n\n    localMatrix: Matrix = new Matrix();\n    globalMatrix: Matrix = new Matrix();\n\n    onStart() {\n    }\n\n    onEditorUpdate() {\n        this.onUpdate();\n    }\n\n    onUpdate() {\n        this.localMatrix.updateFromDisplayObject(this.x, this.y, this.scaleX, this.scaleY, this.rotation);\n        const parent = this.displayObject.parent;\n        if (parent) {\n            const parentTransform = this.displayObject.parent.getScript(Transform);\n            this.globalMatrix = matrixAppendMatrix(this.localMatrix, parentTransform.globalMatrix);\n        }\n    }\n}\n\nconsole.log('after Transform')\n\nexport class HitTestScript extends Behaviour {\n\n    onClick: (localX: number, localY: number) => void;\n\n    private clickLocalX: number;\n    private clickLocalY: number;\n\n    hitTestArea = { x: 0, y: 0, width: 100, height: 100 };\n\n\n    hitTest(clickLocalX: number, clickLocalY: number) {\n        this.clickLocalX = clickLocalX;\n        this.clickLocalY = clickLocalY;\n        const displayObject = this.displayObject;\n        const length = displayObject.children.length - 1;\n        for (let i = length; i >= 0; i--) {\n            const child = displayObject.children[i];\n            const localMatrix = child.getScript(Transform).localMatrix;\n            const invertLocalMatrix = invertMatrix(localMatrix);\n            const clickLocalPoint = new Point(clickLocalX, clickLocalY);\n            //相对于子对象的相对坐标 = 相对于当前对象的相对坐标 * 子对象的相对矩阵的逆矩阵\n            const childLocalPoint = pointAppendMatrix(clickLocalPoint, invertLocalMatrix);\n            const childHitTestScript = child.getScript(HitTestScript);\n            const result = childHitTestScript.hitTest(childLocalPoint.x, childLocalPoint.y);\n            if (result) {\n                return result;\n            }\n        }\n\n        const renderNode = this.displayObject.renderNode;\n        if (renderNode) {\n            const renderArea = renderNode.getRenderArea();\n            if (renderArea) {\n                if (clickLocalX >= 0 && clickLocalX <= renderArea.width &&\n                    clickLocalY >= 0 && clickLocalY <= renderArea.height) {\n                    return displayObject;\n                }\n                else {\n                    return null;\n                }\n            }\n            return null;\n        }\n        else {\n            return null;\n        }\n    }\n\n    onStart() {\n    }\n\n    onUpdate() {\n    }\n\n}\n\nregisterScript(Transform);\nregisterScript(HitTestScript);\nregisterScript(SpriteRenderer);\nregisterScript(TextRenderer);\n\n\nexport function isEditorMode() {\n    return getPlatform().isEditorMode();\n}\n\nwindow['editorAPI'] = editorAPI;\nexport const core = new GameEngineCore();\n\n","import { astar } from \"./astar\";\nimport { CommandBase, CommandPool } from \"./command\";\nimport { uiPrefabData } from \"./data\";\nimport { Behaviour, GameEngineCore, GameObject, getGameObjectById, HitTestScript, registerScript, TextRenderer, Transform, isEditorMode, core } from \"./gameengine\";\nimport { ItemLayerBehaviour, UseItemCommand } from \"./item\";\nimport { NpcBehaviour } from \"./npc\";\nimport { TileMapRenderer } from \"./tilemap\";\nimport { user } from \"./user\";\nimport { Slider } from \"./game/Slider\";\nimport { Menu } from \"./game/Menu\";\nimport { UpdateScoreBehaviour } from \"./game/UpdateScoreBehaviour\";\nimport { GamePlayBehaviour } from \"./game/GamePlayBehaviour\";\n\nexport class WalkableBehaviour extends Behaviour {\n\n    private path: { x: number, y: number }[] = [];\n\n    private speedY: number = 0;\n    private speedX: number = 0;\n\n    private pathIndex = 0;\n\n    onFinished: Function;\n\n    onStart() {\n    }\n\n    setStartPosition(startX: number, startY: number) {\n        const transform = this.displayObject.getScript(Transform);\n        transform.x = startX;\n        transform.y = startY;\n    }\n\n    goto(path: { x: number, y: number }[]) {\n        this.path = path;\n        this.pathIndex = 0;\n\n    }\n\n    onUpdate() {\n        if (!this.path[this.pathIndex]) {\n            return;\n        }\n        const transform = this.displayObject.getScript(Transform);\n\n        const targetX = this.path[this.pathIndex].x;\n        const targetY = this.path[this.pathIndex].y;\n        if (transform.y === targetY) {\n            this.speedY = 0;\n        }\n        else if (transform.y < targetY) {\n            this.speedY = 1;\n        }\n        else {\n            this.speedY = -1;\n        }\n        if (transform.x === targetX) {\n            this.speedX = 0;\n        }\n        else if (transform.x < targetX) {\n            this.speedX = 1;\n        }\n        else {\n            this.speedX = -1;\n        }\n\n\n        const arrivedSingleTarget = transform.x === targetX && transform.y === targetY;\n        if (arrivedSingleTarget) {\n            this.pathIndex++;\n            if (this.pathIndex >= this.path.length) {\n                if (this.onFinished) {\n                    this.onFinished();\n                }\n            }\n        }\n\n\n        transform.x += this.speedX;\n        transform.y += this.speedY;\n    }\n\n}\n\n\nclass WalkCommand extends CommandBase {\n\n    private walkable: WalkableBehaviour;\n    private tileX: number;\n    private tileY: number;\n    constructor(walkable: WalkableBehaviour, tileX: number, tileY: number) {\n        super();\n        this.walkable = walkable;\n        this.tileX = tileX;\n        this.tileY = tileY;\n    }\n\n    execute() {\n\n        const findpath = new astar.FindPath();\n        const tilemap = getGameObjectById(\"tilemap\");\n        const grid = tilemap.getScript(TileMapRenderer).grid;\n        findpath.setHeurisitic(findpath.euclidian);\n        const transform = this.walkable.displayObject.getScript(Transform);\n        const startX = Math.floor(transform.x / 64);\n        const startY = Math.floor(transform.y / 64);\n\n        const paths = findpath.findPath(grid, startX, startY, this.tileX, this.tileY);\n        if (paths) {\n            const path = paths.map(node => {\n                return { x: node.x * 64, y: node.y * 64 }\n            });\n            path.shift();\n            this.walkable.onFinished = () => {\n                this.onFinished();\n            }\n            this.walkable.goto(path);\n        }\n        else {\n            this.onFinished();\n        }\n\n    }\n\n    cancel(): void {\n        console.log('取消移动')\n    }\n}\n\nclass TalkCommand extends CommandBase {\n    private ui: GameObject;\n    execute(): void {\n        const ui = core.createPrefab(uiPrefabData);\n        const uiRoot = getGameObjectById(\"UIRoot\");\n        uiRoot.getScript(HitTestScript).onClick = () => {\n            uiRoot.removeChild(ui);\n            this.onFinished();\n        }\n        uiRoot.addChild(ui);\n        this.ui = ui;\n    }\n\n    cancel() {\n        const uiRoot = getGameObjectById(\"UIRoot\");\n        uiRoot.removeChild(this.ui);\n    }\n\n}\n\nexport class MainRoleBehaviour extends Behaviour {\n\n    private commandPool = new CommandPool();\n\n\n    private goto(tileX: number, tileY: number) {\n        const walkable = this.displayObject.getScript(WalkableBehaviour)\n        const walkCommand1 = new WalkCommand(walkable, tileX, tileY);\n        this.commandPool.push(walkCommand1);\n\n\n\n        const itemLayer = getGameObjectById('itemLayer');\n        const itemLayerBehaviour = itemLayer.getScript(ItemLayerBehaviour);\n        const item = itemLayerBehaviour.getItemByTileXY(tileX, tileY);\n        if (item) {\n            const useItemCommand = new UseItemCommand(item);\n            this.commandPool.push(useItemCommand);\n        }\n        else {\n            const talkCommand = new TalkCommand();\n            this.commandPool.push(talkCommand);\n        }\n\n        // const walkCommand2 = new WalkCommand(walkable, 0, 0);\n\n        // this.commandPool.push(talkCommand);\n\n        // this.commandPool.push(walkCommand2);\n        this.commandPool.seriesExecuteAllCommand();\n\n    }\n\n    onStart() {\n        const tilemap = getGameObjectById(\"tilemap\");\n        const hitTest = tilemap.getScript(HitTestScript);\n        hitTest.onClick = (localX, localY) => {\n            const tileX = Math.floor(localX / 64);\n            const tileY = Math.floor(localY / 64);\n            this.goto(tileX, tileY);\n        }\n\n    }\n    onUpdate() {\n\n    }\n}\n\n\n\nexport class TopUIBehaviour extends Behaviour {\n    onStart() {\n\n    }\n    onUpdate() {\n        const text = this.displayObject.getScript(TextRenderer);\n        text.text = user.gold.toString();\n    }\n}\n\n\n\nregisterScript(TileMapRenderer);\nregisterScript(MainRoleBehaviour);\nregisterScript(WalkableBehaviour);\nregisterScript(NpcBehaviour);\nregisterScript(ItemLayerBehaviour);\nregisterScript(TopUIBehaviour);\nregisterScript(Slider);\nregisterScript(Menu);\nregisterScript(UpdateScoreBehaviour);\nregisterScript(GamePlayBehaviour);\n\ncore.loadImage(\"assets/icon.jpg\");\ncore.loadImage(\"assets/font.png\");\ncore.loadImage(\"assets/0.png\");\ncore.loadImage(\"assets/1.png\");\ncore.loadImage(\"assets/item1.png\");\ncore.loadImage(\"assets/item2.png\");\ncore.loadImage(\"assets/scene.png\");\ncore.loadImage(\"assets/kuafu.png\");\ncore.loadImage(\"assets/sun.png\");\n\n\ncore.start();\n\nif (!isEditorMode()) {\n    core.loadScene('assets/menu.scene.json')\n}\n\n","import { Behaviour, GameObject, Transform, SpriteRenderer, isEditorMode, SerilizeField, propertyEditor_None } from \"./gameengine\";\nimport { core } from \"./gameengine\";\nimport { itemPrefab } from \"./data\";\nimport { CommandBase } from \"./command\";\nimport { user } from \"./user\";\nimport { ItemConfigType, itemConfig } from \"./config\";\n\nexport class ItemLayerBehaviour extends Behaviour {\n\n\n    private items: Item[] = [];\n    @SerilizeField(propertyEditor_None)\n    private itemData: any[];\n\n    onStart() {\n\n        if (!isEditorMode()) {\n            for (let itemData of this.itemData) {\n                const itemGameObject = core.createPrefab(itemPrefab);\n                const transform = itemGameObject.getScript(Transform);\n                const cId = itemData.cId;\n\n                transform.x = itemData.x * 64;\n                transform.y = itemData.y * 64;\n                let gameItem: Item;\n                if (cId == 1) {\n                    gameItem = new HpItem(cId);\n                }\n                else if (cId == 2) {\n                    gameItem = new GoldItem(cId);\n                }\n                if (gameItem) {\n                    gameItem.x = itemData.x;\n                    gameItem.y = itemData.y;\n                    gameItem.cId = itemData.cId;\n                    gameItem.uId = itemData.uId;\n                    const spriteRenderer = itemGameObject.getScript(SpriteRenderer);\n                    spriteRenderer.imageName = gameItem.config.iconName;\n                    this.items.push(gameItem);\n                    gameItem.itemGameObject = itemGameObject;\n                }\n                this.displayObject.addChild(itemGameObject);\n            }\n        }\n\n    }\n\n    onUpdate() {\n    }\n\n    getItemByTileXY(tileX: number, tileY: number): Item {\n        const result = this.items.find(item => item.x === tileX && item.y === tileY);\n        if (result) {\n            return result;\n        }\n        else {\n            return null;\n        }\n    }\n}\n\nexport abstract class Item {\n\n    uId: number;\n    cId: number;\n    x: number;\n    y: number;\n    itemGameObject: GameObject;\n    config: ItemConfigType;\n\n    constructor(cId: number) {\n        this.config = itemConfig.find(config => config.id === cId);\n    }\n\n    /**\n     * 使用一个道具，如果使用完需要消失，返回true,否则返回 false\n     */\n    use(): boolean {\n\n        return false;\n    }\n}\n\nexport class HpItem extends Item {\n\n    use() {\n        console.log(`你使用了${this.config.name}`);\n        return true;\n    }\n}\n\n\nexport class GoldItem extends Item {\n\n    use() {\n        user.gold += 100;\n        return true;\n    }\n}\n\n\nexport class UseItemCommand extends CommandBase {\n\n    private item: Item;\n    constructor(item: Item) {\n        super();\n        this.item = item;\n    }\n\n    execute() {\n        const needDisappear = this.item.use();\n        if (needDisappear) {\n            const gameObject = this.item.itemGameObject;\n            gameObject.parent.removeChild(gameObject);\n        }\n\n\n        this.onFinished();\n    }\n\n    cancel() {\n\n    }\n}","\n\n/**\n * 数学相关类，由于本引擎是一个 2D 游戏引擎，所以内置的 Point 只有 x,y 两个属性，并且矩阵是个 3*3 矩阵\n * 扩展阅读：矩阵运算的几何意义是什么？ \n * https://www.zhihu.com/question/21351965/answer/204058188\n */\n\n\n/**\n * 表示一个点，也等价于一个二维向量\n */\nexport class Point {\n    x: number;\n    y: number;\n    constructor(x: number, y: number) {\n        this.x = x;\n        this.y = y;\n    }\n}\n\n/**\n * \n * @param point 矩阵与向量相乘\n */\nexport function pointAppendMatrix(point: Point, m: Matrix): Point {\n    var x = m.a * point.x + m.c * point.y + m.tx;\n    var y = m.b * point.x + m.d * point.y + m.ty;\n    return new Point(x, y);\n\n}\n\n/**\n * 使用伴随矩阵法求逆矩阵\n * http://wenku.baidu.com/view/b0a9fed8ce2f0066f53322a9\n */\nexport function invertMatrix(m: Matrix): Matrix {\n\n\n    var a = m.a;\n    var b = m.b;\n    var c = m.c;\n    var d = m.d;\n    var tx = m.tx;\n    var ty = m.ty;\n\n    var determinant = a * d - b * c;\n    var result = new Matrix(1, 0, 0, 1, 0, 0);\n    if (determinant == 0) {\n        throw new Error(\"no invert\");\n    }\n\n    determinant = 1 / determinant;\n    var k = result.a = d * determinant;\n    b = result.b = -b * determinant;\n    c = result.c = -c * determinant;\n    d = result.d = a * determinant;\n    result.tx = -(k * tx + c * ty);\n    result.ty = -(b * tx + d * ty);\n    return result;\n\n}\n\n/**\n * \n * 矩阵与矩阵相乘\n */\nexport function matrixAppendMatrix(m1: Matrix, m2: Matrix): Matrix {\n\n    var result = new Matrix();\n    result.a = m1.a * m2.a + m1.b * m2.c;\n    result.b = m1.a * m2.b + m1.b * m2.d;\n    result.c = m2.a * m1.c + m2.c * m1.d;\n    result.d = m2.b * m1.c + m1.d * m2.d;\n    result.tx = m2.a * m1.tx + m2.c * m1.ty + m2.tx;\n    result.ty = m2.b * m1.tx + m2.d * m1.ty + m2.ty;\n    return result;\n}\n\nvar PI = Math.PI;\nvar HalfPI = PI / 2;\nvar PacPI = PI + HalfPI;\nvar TwoPI = PI * 2;\nvar DEG_TO_RAD: number = Math.PI / 180;\n\n\n\n\n\nexport class Matrix {\n\n    constructor(a: number = 1, b: number = 0, c: number = 0, d: number = 1, tx: number = 0, ty: number = 0) {\n        this.a = a;\n        this.b = b;\n        this.c = c;\n        this.d = d;\n        this.tx = tx;\n        this.ty = ty;\n    }\n\n\n    public a: number;\n\n    public b: number;\n\n    public c: number;\n\n    public d: number;\n\n    public tx: number;\n\n    public ty: number;\n\n\n    /**\n     * 返回将 Matrix 对象表示的几何转换应用于指定点所产生的结果。\n     */\n    public toString(): string {\n        return \"(a=\" + this.a + \", b=\" + this.b + \", c=\" + this.c + \", d=\" + this.d + \", tx=\" + this.tx + \", ty=\" + this.ty + \")\";\n    }\n\n    /**\n     * 根据显示对象的属性确定当前矩阵\n     */\n    updateFromDisplayObject(x: number, y: number, scaleX: number, scaleY: number, rotation: number) {\n\n        this.tx = x;\n        this.ty = y;\n\n        var skewX, skewY;\n        skewX = skewY = rotation / 180 * Math.PI;;\n\n        if ((skewX == 0 || skewX == TwoPI) && (skewY == 0 || skewY == TwoPI)) {\n            this.a = scaleX;\n            this.b = this.c = 0;\n            this.d = scaleY;\n            return;\n        }\n\n        var u = Math.cos(skewX);\n        var v = Math.sin(skewX);\n        if (skewX == skewY) {\n            this.a = u * scaleX;\n            this.b = v * scaleX;\n        } else {\n            this.a = Math.cos(skewY) * scaleX;\n            this.b = Math.sin(skewY) * scaleX;\n        }\n        this.c = -v * scaleY;\n        this.d = u * scaleY;\n\n    }\n}","import { Behaviour, getGameObjectById, SerilizeField, propertyEditor_None } from \"./gameengine\";\nimport { WalkableBehaviour } from \".\";\n\n\nexport class NpcBehaviour extends Behaviour {\n    @SerilizeField(propertyEditor_None)\n    private patrol: { x: number, y: number }[] = [];\n    onStart() {\n        const walkable = this.displayObject.getScript(WalkableBehaviour);\n        walkable.goto(this.patrol.map(node => {\n            return {\n                x: node.x * 64,\n                y: node.y * 64\n            }\n        }));\n        walkable.onFinished = () => {\n            this.patrol = this.patrol.reverse();\n            console.log(this.patrol)\n            walkable.goto(this.patrol.map(node => {\n                return {\n                    x: node.x * 64,\n                    y: node.y * 64\n                }\n            }));\n        }\n        // const npcBehaviour = getGameObjectById(\"npcLayer\").getScript(NPCLayerBehaviour);\n        // npcBehaviour.addNPC(this);\n    }\n    onUpdate() {\n\n    }\n}\n\nexport class NPCLayerBehaviour extends Behaviour {\n\n\n    private npcs: NpcBehaviour[] = [];\n    addNPC(npc: NpcBehaviour) {\n        this.npcs.push(npc);\n    }\n\n    getNPCBYTileXY(tileX: number, tileY: number) {\n\n    }\n\n    onStart() {\n    }\n    onUpdate() {\n    }\n}","let platform: Platform;\n\nexport function getPlatform() {\n    if (platform) {\n        return platform;\n    }\n    if (window['canvas']) {\n        platform = new WxgamePlatform();\n    }\n    else {\n        platform = new BrowserPlatform();\n    }\n    return platform;\n}\n\nabstract class Platform {\n\n    abstract loadText(url: string, callback: Function): void;\n\n    abstract getMainCanvas(): HTMLCanvasElement;\n\n    abstract isEditorMode(): boolean;\n\n    abstract listenClick(callback): void;\n\n    abstract listenTouch(callabck: (event: {clickX:number,clickY:number,touchId:number,type:\"touchstart\" | \"touchend\"}) => void): void;\n}\n\n\nclass BrowserPlatform extends Platform {\n\n\n    listenTouch(callback) {\n        const canvas = this.getMainCanvas();\n        canvas.ontouchstart = (e) => {\n            for (let i = 0; i < e.changedTouches.length; i++) {\n                const touch = e.changedTouches[i];\n                const event = { clickX: touch.clientX, clickY: touch.clientY, touchId: touch.identifier ,type:\"touchstart\"};\n                callback(event)\n            }\n            e.preventDefault();\n        }\n        // canvas.ontouchmove = (event) => {\n        //     callback(event)\n        // }\n        canvas.ontouchend = (e) => {\n            for (let i = 0; i < e.changedTouches.length; i++) {\n                const touch = e.changedTouches[i];\n                const event = { clickX: touch.clientX, clickY: touch.clientY, touchId: touch.identifier ,type:\"touchend\"};\n                callback(event)\n            }\n            e.preventDefault();\n        }\n    }\n\n\n    listenClick(callback: any): void {\n        const canvas = this.getMainCanvas();\n        canvas.onclick = (e) => {\n            const rect = canvas.getBoundingClientRect();\n            const clickX = Math.round(e.clientX - rect.left);\n            const clickY = Math.round(e.clientY - rect.top);\n            callback(clickX, clickY);\n        }\n    }\n\n\n\n    isEditorMode(): boolean {\n        return location.search.indexOf(\"editorMode=1\") >= 0;\n    }\n    getMainCanvas(): HTMLCanvasElement {\n        return document.getElementById(\"gameCanvas\") as HTMLCanvasElement;\n    }\n    loadText(url: string, callback: Function): void {\n        const xhr = new XMLHttpRequest();\n        xhr.onload = () => {\n            callback(xhr.responseText);\n        }\n        xhr.open(\"get\", url);\n        xhr.send();\n    }\n\n}\n\nclass WxgamePlatform extends Platform {\n\n    private scale: number = 1;\n\n    listenTouch(callback) {\n        wx.onTouchStart((event) => {\n            callback(event)\n        });\n        wx.onTouchMove((event) => {\n            callback(event)\n        })\n        wx.onTouchEnd((event) => {\n            callback(event)\n        });\n    }\n\n    listenClick(callback: any): void {\n        wx.onTouchStart(result => {\n            const touch = result.touches[0]\n            const clientX = touch.clientX / this.scale;\n            const clientY = touch.clientY / this.scale;\n            console.log(clientX, clientY, this.scale);\n            callback(clientX, clientY);\n        })\n    }\n    isEditorMode(): boolean {\n        return false;\n    }\n    getMainCanvas(): HTMLCanvasElement {\n        const canvas = window['canvas'];\n        const width = canvas.width;\n        const height = canvas.height;\n        const scale = width / height;\n        // canvas.width = 1080;\n        // canvas.height = Math.floor(1080 / scale);\n        this.scale = scale;\n\n        canvas.height=720;\n        canvas.width=Math.floor(scale * 720);\n\n        const ctx=canvas.getContext(\"2d\");\n        ctx.scale(width/canvas.width,width/canvas.width);\n\n        return canvas;\n    }\n    loadText(url: string, callback: Function): void {\n        const fs = wx.getFileSystemManager();\n        const content = fs.readFileSync(url, 'utf-8');\n        callback(content);\n    }\n\n}\n\ndeclare var wx: any","import { astar } from \"./astar\";\nimport { getImage, RenderableBehaviour, SerilizeField, propertyEditor_None } from \"./gameengine\";\nexport class TileMapRenderer extends RenderableBehaviour {\n\n\n    @SerilizeField(propertyEditor_None)\n    tileData: number[][] = [];\n\n    grid: astar.Grid;\n\n    onStart() {\n        this.displayObject.renderNode = this;\n        this.grid = new astar.Grid(6, 4);\n\n        for (let rowIndex = 0; rowIndex < this.tileData.length; rowIndex++) {\n            const row = this.tileData[rowIndex];\n            for (let colIndex = 0; colIndex < row.length; colIndex++) {\n                const walkable = row[colIndex] == 1 ? false : true;\n                this.grid.setWalkable(colIndex, rowIndex, walkable)\n            }\n        }\n    }\n    onUpdate() {\n    }\n\n    onRender(context: CanvasRenderingContext2D) {\n        for (let rowIndex = 0; rowIndex < this.tileData.length; rowIndex++) {\n            const row = this.tileData[rowIndex];\n            for (let colIndex = 0; colIndex < row.length; colIndex++) {\n                const data = row[colIndex];\n                const imageUrl = `assets/${data}.png`;\n                const image = getImage(imageUrl);\n                context.drawImage(image, colIndex * 64, rowIndex * 64);\n            }\n        }\n    }\n\n\n    getRenderArea() {\n        return {\n            x: 0,\n            y: 0,\n            width: this.grid.numCols * 64,\n            height: this.grid.numRows * 64\n        }\n    }\n}","import { Item } from \"./item\";\n\nexport class User {\n\n    name: string = \"\";\n\n    gold: number = 100;\n\n    bag: Item[] = [];\n\n    score:number = 0;\n}\n\n\nexport const user = new User();"],"sourceRoot":""}